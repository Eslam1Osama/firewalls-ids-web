<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Security Learning Module - Firewalls & IDS</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Interactive learning module for Data Security course covering Firewalls, Intrusion Detection Systems, and Network Security fundamentals. Created for ECE4304 at AASTMT.">
    <meta name="keywords" content="data security, firewalls, intrusion detection, network security, cybersecurity, learning module, AASTMT, ECE4304">
    <meta name="author" content="Eng. Eslam Osama">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://firewalls-ids-web.vercel.app/">
    <meta property="og:title" content="Data Security Learning Module - Firewalls & IDS">
    <meta property="og:description" content="Interactive learning module for Data Security course covering Firewalls, Intrusion Detection Systems, and Network Security fundamentals.">
    <meta property="og:image" content="https://firewalls-ids-web.vercel.app/assets/logo.svg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Data Security Learning Module">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://firewalls-ids-web.vercel.app/">
    <meta name="twitter:title" content="Data Security Learning Module - Firewalls & IDS">
    <meta name="twitter:description" content="Interactive learning module for Data Security course covering Firewalls, Intrusion Detection Systems, and Network Security fundamentals.">
    <meta name="twitter:image" content="https://firewalls-ids-web.vercel.app/assets/logo.svg">
    <meta name="twitter:creator" content="@eslam_osama">

    <!-- Favicon and Icons -->
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="apple-touch-icon" href="assets/logo.svg">
    <link rel="icon" href="assets/favicon.svg" sizes="any">
    <link rel="manifest" href="manifest.json">

    <!-- Microsoft Tiles -->
    <meta name="msapplication-TileColor" content="#00ACC1">
    <meta name="msapplication-config" content="browserconfig.xml">
    <meta name="theme-color" content="#00ACC1">

    <!-- PWA Meta Tags -->
    <meta name="application-name" content="Data Security Learning Module">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Data Security Module">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-starturl" content="/">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script> Removed jsPDF as we are switching to DOCX -->
    <!-- <script src="https://unpkg.com/docx@latest/build/index.js"></script> Removed DOCX library as we are switching to ZIP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        :root {
            --primary: #00ACC1; /* main blue */
            --secondary: #4DD0E1; /* lighter blue */
            --accent: #80DEEA; /* accent blue */
            --blue1: #B2EBF2;
            --blue2: #E0F7FA;
            --blue3: #F3FBFC;
            --text-main: #00323d; /* deep blue for contrast */
            --text-secondary: #006978; /* medium blue for secondary text */
            --bg-gradient: linear-gradient(135deg, var(--primary) 0%, var(--blue2) 100%);
            --section-bg: rgba(255,255,255,0.98);
            --header-bg: rgba(255,255,255,0.85);
            --footer-bg: linear-gradient(135deg, var(--primary) 0%, var(--blue2) 100%);
            --nav-bg: rgba(255,255,255,0.95);
            --nav-btn-bg: linear-gradient(90deg, var(--primary), var(--secondary));
            --nav-btn-active-bg: linear-gradient(90deg, var(--secondary), var(--accent));
            --transition: all 0.3s cubic-bezier(.4,2,.6,1);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
        }
        [data-theme="dark"] {
            --primary: #00ACC1;
            --secondary: #4DD0E1;
            --accent: #80DEEA;
            --blue1: #00323d;
            --blue2: #006978;
            --blue3: #222f3e;
            --text-main: #E0F7FA;
            --text-secondary: #B2EBF2;
            --bg-gradient: linear-gradient(135deg, #00323d 0%, #006978 100%);
            --section-bg: rgba(0, 50, 61, 0.98);
            --header-bg: rgba(0, 50, 61, 0.85);
            --footer-bg: linear-gradient(135deg, #00323d 0%, #006978 100%);
            --nav-bg: rgba(0, 50, 61, 0.95);
            --nav-btn-bg: linear-gradient(90deg, #00323d, #4DD0E1);
            --nav-btn-active-bg: linear-gradient(90deg, #4DD0E1, #00323d);
            --transition: all 0.3s cubic-bezier(.4,2,.6,1);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-main);
            background: var(--bg-gradient);
            min-height: 100vh;
            font-size: 16px; /* Base font size */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px; /* Base padding */
        }

        .header {
            text-align: center;
            color: var(--text-main);
            margin-bottom: 30px;
            padding: 40px 20px; /* Base padding */
            background: var(--header-bg);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
            position: relative; /* Restored for theme-toggle positioning */
            overflow: hidden;
            padding-top: 60px; /* Add extra space at the top for the toggle */
            /* Ensure NO 'display: flex', 'flex-direction', or 'align-items' here */
        }

        .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(255,255,255,0.2) 0%, transparent 40%);
            pointer-events: none;
        }

        .header h1 {
            font-size: clamp(1.8em, 5vw, 2.5em); /* Fluid font size */
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: clamp(1em, 2.5vw, 1.2em); /* Fluid font size */
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
        }

        .download-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 5px;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .download-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .navigation {
            background: var(--nav-bg); backdrop-filter: blur(10px); border-radius: 50px;
            padding: 15px; margin-bottom: 30px; display: flex; justify-content: center;
            flex-wrap: wrap; gap: 10px; position: sticky; top: 10px; z-index: 100;
        }

        .nav-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .nav-btn {
            background: var(--nav-btn-bg); color: white; border: none; padding: 12px 20px;
            border-radius: 25px; cursor: pointer; transition: var(--transition); font-weight: 500;
            display: flex; align-items: center; gap: 8px;
        }

        .nav-btn:hover, .nav-btn.active {
            background: var(--nav-btn-active-bg);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.12);
        }

        @media (max-width: 768px) {
            .nav-buttons {
                flex-direction: column;
            }
        }

        .section {
            background: var(--blue1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            position: relative;
            display: none;
        }
        .section.active {
            display: block;
        }

        .section-title {
            color: var(--primary);
            font-size: clamp(1.4em, 4vw, 1.8em); /* Fluid font size */
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--secondary);
            display: flex;
            align-items: center;
            text-align: left;
        }

        .image-placeholder {
            width: 100%;
            max-width: 800px;
            min-height: unset;
            background: none;
            border: none;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            padding: 0;
        }
        .image-placeholder i,
        .image-placeholder p {
            display: none !important;
        }
        .card-image {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .card-image img {
            width: 100%;
            height: auto;
            object-fit: contain;
            display: block;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .firewall-card {
            background: var(--section-bg);
            color: var(--text-main);
            box-shadow: var(--shadow);
            border-radius: 15px;
            padding: 24px 20px 20px 20px;
        }
        [data-theme="dark"] .firewall-card {
            background: var(--blue3);
            color: var(--text-main);
        }

        .intro-image-float {
            float: right;
            max-width: 60%;
            margin: 0 0 20px 20px;
            min-height: unset;
            border: none;
            background: none;
        }

        .intro-image-float.left {
            float: left;
            margin: 0 20px 20px 0;
        }

        .intro-image-float .card-image {
            padding: 0;
        }

        .image-placeholder i {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .intro-main-definition {
            font-size: 1.2em;
            line-height: 1.8;
            margin-bottom: 30px;
            color: var(--text-main);
        }

        #intro h4 {
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 15px;
            color: var(--primary);
            border-bottom: 2px solid var(--blue1);
            padding-bottom: 5px;
        }

        #intro ol,
        #intro ul {
            list-style-position: outside;
            margin-left: 25px;
            margin-bottom: 20px;
        }

        #intro li {
            font-size: 1.05em;
            line-height: 1.7;
            margin-bottom: 12px;
            color: var(--text-main);
        }

        #intro li strong {
            color: var(--primary);
        }

        #intro ul ul {
            margin-left: 20px;
            margin-top: 8px;
            list-style-type: disc;
        }

        #intro ul ul li {
            font-size: 0.95em;
            line-height: 1.6;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        .attacks-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--section-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .attacks-table th {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: var(--section-bg);
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }

        .attacks-table td {
            padding: 15px;
            border-bottom: 1px solid var(--blue1);
            color: var(--text-main);
        }

        .attacks-table tr:hover {
            background-color: var(--blue1);
        }

        .threat-level {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .threat-low { background: var(--blue1); color: var(--primary); }
        .threat-moderate { background: var(--accent); color: var(--primary); }
        .threat-high { background: var(--secondary); color: var(--text-main); }
        .threat-critical { background: var(--primary); color: var(--section-bg); }

        .key-differences {
            background: var(--blue1);
            border-left: 4px solid var(--primary);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            color: var(--text-main);
        }

        .key-differences h4 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .key-differences ol {
            margin-left: 20px;
        }

        .key-differences li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .review-questions {
            background: var(--blue1);
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
            color: var(--text-main);
        }

        .review-questions h3 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: clamp(1.4em, 3.5vw, 1.7em); /* Fluid font size */
            font-weight: bold;
            text-shadow: 0 2px 8px rgba(0,0,0,0.10);
        }

        .question {
            background: var(--section-bg);
            color: var(--text-main);
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .question:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .question-title {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.1em;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-shadow: 0 1px 4px rgba(0,0,0,0.08);
        }

        .question-title .arrow-icon {
            font-size: 0.8em;
            transition: transform 0.3s ease;
            opacity: 0;
        }

        .question:hover .arrow-icon {
            opacity: 1;
        }

        .question.active .arrow-icon {
            transform: rotate(180deg);
            opacity: 1;
        }

        .question-answer {
            color: var(--text-secondary);
            max-height: 0;
            overflow: hidden;
            padding-top: 0; /* Set to 0 when collapsed */
            margin-top: 0; /* Set to 0 when collapsed */
            border-top: 1px solid var(--blue2);
            transition: max-height 0.3s ease-out, padding-top 0.3s ease-out, margin-top 0.3s ease-out;
        }

        .question.active .question-answer {
            max-height: 1000px; /* Adjust as needed */
            padding-top: 10px; /* Apply padding when open */
            margin-top: 10px; /* Apply margin when open */
            animation: none; /* Remove fadeIn animation */
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .highlight {
            background: linear-gradient(120deg, var(--secondary) 0%, var(--accent) 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
            color: var(--text-main);
        }

        .rsa-section {
            text-align: center;
            padding: 40px 30px;
            background: var(--blue1);
            color: var(--text-main);
            border-radius: 20px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }

        .rsa-section h3 {
            font-size: clamp(1.8em, 4.5vw, 2.2em); /* Fluid font size */
            margin-bottom: 25px;
            color: var(--primary);
            font-weight: bold;
            text-shadow: 0 2px 8px rgba(0,0,0,0.10);
        }

        [data-theme="dark"] .rsa-section h3 {
            text-shadow: 0 2px 12px rgba(0,0,0,0.45);
        }

        .rsa-description-text {
            text-align: center;
            color: var(--text-main);
            font-size: clamp(1em, 2vw, 1.1em); /* Fluid font size */
            line-height: 1.7;
            max-width: 700px;
            margin: 20px auto;
            padding: 0 15px;
        }

        .rsa-confidentiality-intro {
            font-size: clamp(1.1em, 2.5vw, 1.3em); /* Fluid font size */
            color: var(--secondary);
            font-weight: bold;
            margin-bottom: 15px;
            text-shadow: 0 1px 4px rgba(0,0,0,0.08);
        }

        [data-theme="dark"] .rsa-confidentiality-intro {
            color: var(--accent);
            text-shadow: 0 2px 8px rgba(0,0,0,0.35);
        }

        .rsa-image-caption {
            font-size: clamp(0.95em, 2vw, 1.05em); /* Fluid font size */
            color: var(--primary);
            font-weight: bold;
            margin-top: 10px;
            margin-bottom: 5px;
            text-shadow: 0 1px 4px rgba(0,0,0,0.08);
        }

        [data-theme="dark"] .rsa-image-caption {
            color: var(--accent);
            text-shadow: 0 2px 8px rgba(0,0,0,0.35);
        }

        .rsa-image-description {
            font-size: clamp(0.9em, 1.8vw, 1em); /* Fluid font size */
            line-height: 1.6;
            color: var(--text-main);
            max-width: 650px;
            margin: 15px auto;
        }

        .rsa-section .image-placeholder {
            background: none;
            border: none;
            max-width: 90%;
            margin: 30px auto;
        }

        @media (max-width: 1200px) {
            .container {
                max-width: 100%;
                padding: 10px;
            }
        }
        @media (max-width: 900px) {
            .header {
                padding: 30px 10px; /* Keep existing padding, will refine padding-top below */
            }
            .section, .rsa-section, .review-questions {
                padding: 18px 8px;
            }
            /* Section titles are now handled by clamp() */
            /* rsa-section h3 and review-questions h3 are now handled by clamp() */
            .objectives-list, .firewall-functions-list, .techniques-grid, .firewall-types {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Adjust min width for tablets */
                gap: 16px;
            }
            .firewall-function-card {
                min-height: 100px; /* Slightly adjust min height */
            }
            .firewall-function-card .function-title {
                font-size: 1.1em;
            }
            .firewall-function-card .function-content {
                font-size: 0.95em;
            }
        }
        @media (max-width: 768px) {
            .container {
                padding: 4px;
            }
            .header {
                padding: 18px 4px; /* Default for this breakpoint, will override padding-top */
                padding-top: 55px; /* Increased padding-top for theme-toggle and title */
            }
            .section, .rsa-section, .review-questions {
                padding: 10px 2vw;
                margin-bottom: 16px;
            }
            /* Section titles, rsa-section h3, review-questions h3 are now handled by clamp() */
            .download-btn, .nav-btn {
                font-size: 0.95em;
                padding: 10px 12px;
            }
            .theme-toggle {
                top: 10px;
                right: 10px;
            }
            .toggle-switch {
                width: 40px;
                height: 22px;
            }
            .toggle-slider {
                width: 16px;
                height: 16px;
            }
            .toggle-switch.dark .toggle-slider {
                left: 18px;
            }
            .image-placeholder, .large-centered-image, .intro-bottom-image {
                max-width: 98vw;
                min-width: 0;
                margin: 15px auto; /* Adjust margin */
            }
            .intro-image-float, .intro-image-float.left {
                float: none;
                display: block;
                margin: 10px auto;
                max-width: 95vw;
            }
            .objectives-list, .firewall-functions-list, .techniques-grid, .firewall-types {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); /* Further adjust min width for smaller tablets/large phones */
                gap: 12px;
            }
            .pros-cons {
                flex-direction: column; /* Stack pros/cons on smaller screens */
                gap: 15px;
            }
            .pros, .cons {
                padding: 15px;
            }
            .pros h5, .cons h5 {
                font-size: 1.1em;
            }
            .firewall-card {
                padding: 20px 15px; /* Adjust card padding */
                margin-bottom: 25px; /* Adjust card margin */
            }
            .subsection-title {
                font-size: clamp(1.2em, 3.5vw, 1.5em); /* Fluid font size */
            }
            .info-network-row {
                flex-direction: column; /* Stack info blocks */
                gap: 15px;
            }
            .info-block {
                padding: 15px;
            }
            .info-block h4 {
                font-size: 1.05em;
            }
            .info-block p {
                font-size: 0.9em;
            }
        }
        @media (max-width: 600px) {
            .header {
                padding-top: 50px; /* Adjust padding-top for this breakpoint */
            }
            .header h1 {
                font-size: clamp(1.0em, 4vw, 1.1em);
            }
            .header p {
                font-size: clamp(0.9em, 2.5vw, 0.95em);
            }
            .attacks-table, .attacks-table th, .attacks-table td {
                font-size: 0.85em;
            }
            .download-btn, .nav-btn {
                font-size: 0.9em;
                padding: 8px 8px;
            }
            .theme-toggle {
                top: 8px; /* Adjusted top for this breakpoint */
            }
            .objectives-list, .firewall-functions-list, .techniques-grid, .firewall-types, .pros-cons {
                grid-template-columns: 1fr; /* Stack all cards on very small screens */
                gap: 10px;
                flex-direction: column;
            }
            .firewall-card {
                padding: 18px 12px;
                margin-bottom: 20px;
            }
            .function-title, .limitation-title, .technique-title, .goals-header, .techniques-header, .limitations-header {
                font-size: 1em !important; /* Force smaller font size for titles */
            }
            .function-content p, .limitation-content, .technique-desc, .goal-desc {
                font-size: 0.9em !important;
            }
            .firewall-function-card {
                min-height: unset; /* Remove min-height */
            }
            .quiz-question .interactive-element h3 {
                font-size: 1.1em !important; /* Adjust quiz question title */
            }
            .quiz-question .toggle-content ol, .quiz-question .toggle-content ul, .quiz-question .toggle-content p {
                font-size: 0.9em !important; /* Adjust quiz answer font size */
            }
            .toggle-arrow {
                font-size: 0.9em;
            }
        }
        @media (max-width: 500px) {
            .header {
                padding-top: 45px; /* Further adjusted padding-top */
            }
            .header h1 {
                font-size: clamp(0.85em, 3.5vw, 0.95em);
            }
            .header p {
                font-size: clamp(0.75em, 2vw, 0.85em);
            }
            .theme-toggle {
                top: 6px; /* Further adjusted top */
            }
        }
        @media (max-width: 400px) {
            .container {
                padding: 2px;
            }
            .header {
                padding: 12px 2px; /* Default for this breakpoint, will override padding-top */
                padding-top: 40px; /* Smallest screen padding-top */
            }
            .section, .rsa-section, .review-questions {
                padding: 8px 1vw;
                margin-bottom: 12px;
            }
            .download-btn, .nav-btn {
                font-size: 0.85em;
                padding: 6px 6px;
            }
            .theme-toggle {
                top: 5px;
                right: 5px;
            }
            .toggle-switch {
                width: 36px;
                height: 20px;
            }
            .toggle-slider {
                width: 14px;
                height: 14px;
            }
            .toggle-switch.dark .toggle-slider {
                left: 16px;
            }
            .firewall-card {
                padding: 15px 10px;
            }
            .function-title, .limitation-title, .technique-title, .goals-header, .techniques-header, .limitations-header {
                font-size: 0.9em !important;
            }
            .function-content p, .limitation-content, .technique-desc, .goal-desc {
                font-size: 0.85em !important;
            }
        }

        /* Responsive tables: horizontal scroll on small screens */
        .attacks-table {
            display: block;
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .attacks-table thead, .attacks-table tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }
        .attacks-table tr {
            display: table-row;
        }
        .attacks-table th, .attacks-table td {
            word-break: break-word;
        }
        /* Make images fluid */
        img {
            max-width: 100%;
            height: auto;
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: var(--blue1);
            border-radius: 3px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.3s ease;
        }

        footer {
            text-align: center;
            padding: 10px;
            margin-top: 20px;
            color: var(--text-secondary);
            font-size: 0.9em;
            background: var(--footer-bg);
        }

        footer p {
            margin: 0;
            color: var(--text-main);
        }

        .large-centered-image {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px auto;
        }

        .intro-bottom-image {
            float: none;
            max-width: 700px;
            margin: 30px auto;
            display: block;
            border: none;
            background: none;
        }

        .intro-left ul ul li {
            font-size: 0.95em;
            line-height: 1.6;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        /* Theme Toggle Switch */
        .theme-toggle {
            position: absolute;
            top: 10px; /* Adjusted to sit tighter in the corner */
            right: 30px;
            z-index: 10;
            display: flex;
            align-items: center;
            /* Ensure NO 'margin-left: auto;' or 'left' property here */
        }
        .toggle-switch {
            width: 56px;
            height: 28px;
            background: var(--blue1);
            border-radius: 20px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-left: 10px; /* Keep for toggle elements within switch */
        }
        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            transition: left 0.3s cubic-bezier(.4,2,.6,1), background 0.3s;
            box-shadow: 0 1px 4px rgba(0,0,0,0.10);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1em;
            color: var(--primary);
            overflow: hidden;
        }
        .toggle-slider .icon-sun,
        .toggle-slider .icon-moon {
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .toggle-slider .icon-sun {
            color: #FFD700;
        }
        .toggle-slider .icon-moon {
            color: var(--primary);
        }
        .toggle-switch:not(.dark) .icon-sun {
            opacity: 1;
        }
        .toggle-switch.dark .icon-moon {
            opacity: 1;
        }
        .toggle-switch.dark {
            background: var(--primary);
        }
        .toggle-switch.dark .toggle-slider {
            left: 31px;
            background: var(--blue3);
            color: var(--primary);
        }
        .toggle-icon {
            font-size: 1.2em;
            color: var(--primary);
        }
        .download-section-btn {
            background: var(--blue2);
            color: var(--text-main);
            border: none;
            border-radius: 50%;
            width: 38px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4em;
            box-shadow: 0 1px 4px rgba(0,0,0,0.15);
            cursor: pointer;
            transition: background 0.2s, transform 0.2s;
            margin-left: auto; /* Pushes the button to the right within the flex container */
            flex-shrink: 0; /* Prevents the button from shrinking */
        }
        .download-section-btn:hover {
            background: var(--blue3); /* Gentler hover effect */
            transform: scale(1.08);
        }
        .download-section-btn.screenshot-hide,
        .download-btn.screenshot-hide {
            display: none !important;
        }
        .download-section-btn i {
            line-height: 1; /* Ensures icon is vertically centered without extra space */
            margin: 0;      /* Remove any default margin */
            padding: 0;     /* Remove any default padding */
        }
        .screenshot-mode.section,
        .screenshot-mode {
            width: 100vw !important;
            max-width: 100vw !important;
            left: 0 !important;
            position: fixed !important;
            top: 0 !important;
            z-index: 9999 !important;
        }
        .screenshot-mode-body {
            width: 100vw !important;
            max-width: 100vw !important;
            overflow: visible !important;
        }
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px;
            text-align: center;
        }

        .copyright-notice {
            margin-top: 8px;
            font-size: 0.85em;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .copyright-notice p {
            margin: 5px 0;
        }

        .terms {
            font-size: 0.85em;
            max-width: 800px;
            margin: 10px auto;
            padding: 10px;
            border-top: 1px solid rgba(255,255,255,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .disclaimer {
            font-size: 0.8em;
            font-style: italic;
            opacity: 0.8;
        }

        [data-theme="dark"] .terms {
            border-color: rgba(255,255,255,0.1);
        }

        @media (max-width: 768px) {
            .copyright-notice {
                font-size: 0.8em;
            }
            .terms {
                font-size: 0.75em;
                padding: 8px;
            }
            .disclaimer {
                font-size: 0.7em;
            }
        }

        /* Add these styles to your existing CSS */
        .copyright-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin: 3px 0;
        }

        .copyright-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .copyright-btn i {
            font-size: 1.1em;
        }

        .notification {
            position: fixed;
            bottom: 20px;
            left: -400px; /* Start off-screen */
            background: var(--section-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            max-width: 380px;
            z-index: 1000;
            transition: left 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .notification.show {
            left: 20px;
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .notification-title {
            font-weight: bold;
            color: var(--primary);
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2em;
            padding: 5px;
            transition: var(--transition);
        }

        .notification-close:hover {
            color: var(--primary);
            transform: rotate(90deg);
        }

        .notification-content {
            color: var(--text-main);
            font-size: 0.9em;
            line-height: 1.6;
        }

        .notification-content p {
            margin: 8px 0;
        }

        .notification-content .disclaimer {
            font-style: italic;
            opacity: 0.8;
            font-size: 0.9em;
            margin-top: 10px;
        }

        @media (max-width: 480px) {
            .notification {
                max-width: calc(100% - 40px);
                left: -100%;
            }
        }

        .objectives-container {
            background: var(--section-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            color: var(--text-main);
            text-align: left;
        }

        .subsection-title {
            color: var(--primary);
            font-size: clamp(1.2em, 3.5vw, 1.5em); /* Fluid font size */
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid var(--secondary);
            display: flex;
            align-items: center;
        }

        .definition-box {
            background: var(--blue2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            color: var(--text-main);
            text-align: left;
        }

        .objectives-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .objective-card {
            background: var(--primary);
            color: var(--section-bg);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            text-align: left;
            word-break: break-word;
        }
        [data-theme="dark"] .objective-card {
            background: var(--blue1); /* Dark blue background for better contrast */
            color: var(--text-main); /* Light text for dark mode */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); /* Enhanced shadow for dark mode */
        }

        .objective-card h4 {
            font-size: clamp(1.1em, 2.5vw, 1.2em); /* Fluid font size */
            margin-bottom: 10px;
            color: var(--accent);
            text-align: left;
        }

        [data-theme="dark"] .objective-card h4 {
            color: var(--text-main); /* Light color for headings in dark mode */
        }

        .objective-card p {
            font-size: clamp(0.9em, 1.8vw, 1em); /* Fluid font size */
            line-height: 1.6;
            opacity: 0.95;
            color: inherit;
            text-align: left;
        }

        .toggle-content {
            max-height: 0;
            overflow: hidden;
            margin-top: 0; /* Set to 0 when collapsed */
            padding: 0; /* Set to 0 when collapsed */
            background: var(--blue3);
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: max-height 0.3s ease-out, margin-top 0.3s ease-out, padding 0.3s ease-out;
        }
        /* Reset margins/paddings for direct children when collapsed */
        .toggle-content:not(.show) > * {
            margin: 0 !important;
            padding: 0 !important;
            transition: margin 0.3s ease-out, padding 0.3s ease-out; /* Add transition for children's spacing */
        }

        .toggle-content strong {
            color: var(--secondary);
            font-weight: bold;
        }
        .toggle-content.show {
            max-height: 2000px; /* A large value to ensure content fits */
            margin-top: 10px; /* Apply margin when open */
            padding: 10px; /* Apply padding when open */
        }

        .info-vs-network-container {
            background: var(--blue1);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            color: var(--text-main);
            text-align: left;
            margin-top: 32px;
        }

        .info-network-row {
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }

        .info-block {
            flex: 1;
            background: var(--blue2);
            border-radius: 5px;
            padding: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            color: var(--text-main);
            text-align: left;
            word-break: break-word;
        }
        [data-theme="dark"] .info-block {
            background: var(--blue3);
            color: var(--text-main);
        }

        .info-block h4 {
            font-size: clamp(1em, 2vw, 1.1em); /* Fluid font size */
            margin-bottom: 5px;
            color: var(--secondary);
            text-align: left;
        }

        .info-block p {
            font-size: clamp(0.85em, 1.7vw, 0.95em); /* Fluid font size */
            line-height: 1.6;
            opacity: 0.95;
            color: inherit;
            text-align: left;
        }

        .info-block .key-term {
            color: var(--accent);
            font-weight: bold;
        }

        .firewall-functions-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(270px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }

        .firewall-function-card {
            background: linear-gradient(135deg, var(--section-bg) 80%, var(--blue2) 100%);
            border-radius: 14px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.10);
            padding: 22px 20px 14px 20px;
            color: var(--text-main);
            position: relative;
            transition: box-shadow 0.2s, transform 0.2s;
            cursor: pointer;
            min-height: 110px;
            text-align: left;
            border-left: 5px solid var(--primary);
            overflow: hidden;
        }
        [data-theme="dark"] .firewall-function-card {
            background: linear-gradient(135deg, var(--blue3) 80%, var(--blue2) 100%);
            color: var(--text-main);
            border-left: 5px solid var(--secondary);
        }
        .firewall-function-card:hover, .firewall-function-card.open {
            box-shadow: 0 8px 28px rgba(0,0,0,0.18);
            transform: translateY(-2px) scale(1.01);
        }
        .function-title {
            font-size: clamp(1.05em, 2.2vw, 1.18em); /* Fluid font size */
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--primary);
            margin-bottom: 0;
            user-select: none;
            letter-spacing: 0.01em;
        }
        [data-theme="dark"] .function-title {
            color: var(--secondary);
        }
        .function-arrow {
            margin-left: auto;
            opacity: 0;
            transition: opacity 0.2s, transform 0.3s;
            color: var(--primary);
            font-size: 1.18em;
            display: flex;
            align-items: center;
        }
        [data-theme="dark"] .function-arrow {
            color: var(--secondary);
        }
        .firewall-function-card:hover .function-arrow,
        .firewall-function-card.open .function-arrow {
            opacity: 1;
        }
        .firewall-function-card.open .function-arrow i {
            transform: rotate(180deg);
            transition: transform 0.3s;
        }
        .function-content {
            max-height: 0;
            overflow: hidden;
            margin-top: 0;
            padding: 0;
            color: var(--text-main);
            font-size: clamp(0.9em, 1.8vw, 1.04em); /* Fluid font size */
            line-height: 1.7;
            word-break: break-word;
            transition: max-height 0.5s ease-out, margin-top 0.5s ease-out, padding 0.5s ease-out; /* Updated transition to include unified padding */
        }
        /* Reset margins/paddings for direct children when collapsed */
        .firewall-function-card:not(.open) > .function-content > * {
            margin: 0 !important;
            padding: 0 !important;
            transition: margin 0.5s ease-out, padding 0.5s ease-out; /* Add transition for children's spacing */
        }

        [data-theme="dark"] .function-content {
            color: var(--text-main);
        }
        .function-content ul, .function-content ol {
            margin: 10px 0 10px 22px;
            padding-left: 0;
            color: var(--text-main);
            font-size: clamp(0.9em, 1.7vw, 0.98em); /* Fluid font size */
            line-height: 1.6;
        }
        .function-content li {
            margin-bottom: 6px;
            color: var(--text-main);
        }
        .function-content strong {
            color: var(--primary);
        }
        [data-theme="dark"] .function-content strong {
            color: var(--secondary);
        }
        .function-content .key-term {
            color: var(--accent);
            font-weight: bold;
        }

        .firewall-function-card .function-content {
            pointer-events: auto;
        }
        .firewall-function-card.open > .function-content {
            max-height: 2000px; /* A value larger than content will ever be */
            margin-top: 16px; /* Apply margin when open */
            padding: 10px; /* Apply unified padding when open */
        }

        /* CSS for the above sections */
        .firewall-goals-container {
          background: var(--section-bg);
          border-radius: 15px;
          box-shadow: var(--shadow);
          padding: 24px 20px 20px 20px;
          margin-bottom: 28px;
          color: var(--text-main);
        }
        [data-theme="dark"] .firewall-goals-container {
          background: var(--blue3);
          color: var(--text-main);
        }
        .goals-header {
          font-size: clamp(1.1em, 2.2vw, 1.25em); /* Fluid font size */
          font-weight: bold;
          color: var(--primary);
          margin-bottom: 16px;
          display: flex;
          align-items: center;
          gap: 10px;
        }
        [data-theme="dark"] .goals-header {
          color: var(--secondary);
        }
        .goals-list {
          list-style: none;
          padding: 0;
          margin: 0;
        }
        .goal {
          font-size: clamp(1em, 2vw, 1.08em); /* Fluid font size */
          font-weight: bold;
          margin-bottom: 8px;
          padding: 10px 16px;
          border-radius: 8px;
          color: var(--section-bg);
          background: var(--primary);
        }
        .goal-2 { background: var(--secondary); color: var(--text-main); }
        .goal-3 { background: var(--accent); color: var(--text-main); }
        .goal-desc { font-weight: normal; display: block; margin-top: 2px; font-size: clamp(0.9em, 1.7vw, 0.98em); }

        .firewall-techniques-container {
          background: var(--section-bg);
          border-radius: 15px;
          box-shadow: var(--shadow);
          padding: 24px 20px 20px 20px;
          margin-bottom: 28px;
          color: var(--text-main);
        }
        [data-theme="dark"] .firewall-techniques-container {
          background: var(--blue3);
          color: var(--text-main);
        }
        .techniques-header {
          font-size: clamp(1.1em, 2.2vw, 1.25em); /* Fluid font size */
          font-weight: bold;
          color: var(--primary);
          margin-bottom: 16px;
          display: flex;
          align-items: center;
          gap: 10px;
        }
        [data-theme="dark"] .techniques-header {
          color: var(--secondary);
        }
        .techniques-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
          gap: 18px;
        }
        .technique-card {
          border-radius: 10px;
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          padding: 16px 14px 12px 14px;
          color: var(--text-main);
          background: var(--blue2);
          display: flex;
          flex-direction: column;
          gap: 6px;
          min-height: 90px;
        }
        [data-theme="dark"] .technique-card {
          background: var(--blue1);
          color: var(--text-main);
        }
        .technique-service { border-left: 5px solid #4caf50; }
        .technique-direction { border-left: 5px solid #ff9800; }
        .technique-user { border-left: 5px solid #2196f3; }
        .technique-behavior { border-left: 5px solid #e91e63; }
        .technique-title {
          font-size: clamp(1em, 2vw, 1.08em); /* Fluid font size */
          font-weight: bold;
          display: flex;
          align-items: center;
          gap: 8px;
          margin-bottom: 2px;
        }
        .technique-desc {
          font-size: clamp(0.9em, 1.7vw, 0.98em); /* Fluid font size */
          line-height: 1.5;
        }

        .firewall-limitations-container {
          background: var(--section-bg);
          border-radius: 15px;
          box-shadow: var(--shadow);
          padding: 24px 20px 20px 20px;
          margin-bottom: 28px;
          color: var(--text-main);
        }
        [data-theme="dark"] .firewall-limitations-container {
          background: var(--blue3);
          color: var(--text-main);
        }
        .limitations-header {
          font-size: clamp(1.1em, 2.2vw, 1.25em); /* Fluid font size */
          font-weight: bold;
          color: var(--primary);
          margin-bottom: 16px;
          display: flex;
          align-items: center;
          gap: 10px;
        }
        [data-theme="dark"] .limitations-header {
          color: var(--secondary);
        }
        .limitations-list {
          display: flex;
          flex-direction: column;
          gap: 14px;
        }
        .limitation-card {
          background: linear-gradient(90deg, #ffb6b6 60%, #ffd6d6 100%);
          border-radius: 10px;
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          padding: 16px 14px 12px 14px;
          color: #b71c1c;
          font-weight: bold;
          cursor: pointer;
          position: relative;
          transition: box-shadow 0.2s, transform 0.2s;
          min-height: 48px;
          text-align: left;
        }
        [data-theme="dark"] .limitation-card {
          background: linear-gradient(90deg, #b71c1c 60%, #ffb6b6 100%);
          color: var(--section-bg);
        }
        .limitation-title {
          display: flex;
          align-items: center;
          gap: 10px;
          font-size: clamp(1em, 2vw, 1.08em); /* Fluid font size */
          font-weight: bold;
          user-select: none;
        }
        .limitation-arrow {
          margin-left: auto;
          opacity: 0.7;
          color: inherit;
          font-size: 1.1em;
          display: flex;
          align-items: center;
          transition: transform 0.3s;
        }
        .limitation-card.open .limitation-arrow i {
          transform: rotate(180deg);
        }
        .limitation-content {
          display: none;
          margin-top: 10px;
          color: inherit;
          font-size: clamp(0.9em, 1.7vw, 0.98em); /* Fluid font size */
          font-weight: normal;
          line-height: 1.5;
        }
        .limitation-card.open .limitation-content {
          display: block;
          animation: fadeIn 0.3s;
        }
        /* Add this to CSS for uniform goal color */
        .goal-uniform {
          background: var(--primary) !important;
          color: var(--section-bg) !important;
        }
        [data-theme="dark"] .goal-uniform {
          background: var(--primary) !important;
          color: var(--section-bg) !important;
        }

        /* New styles for interactive element arrows */
        .interactive-element h4 {
            position: relative; /* Ensure position for absolute arrow */
        }
        .toggle-arrow {
            margin-left: auto; /* Push arrow to the right */
            opacity: 0.7;
            transition: opacity 0.2s, transform 0.3s;
            color: inherit; /* Inherit color from parent h4 */
            font-size: 1em; /* Adjust size if needed */
            display: flex;
            align-items: center;
        }
        .interactive-element:hover .toggle-arrow {
            opacity: 1; /* Make arrow more visible on hover */
        }
        .interactive-element.open .toggle-arrow i {
            transform: rotate(180deg);
        }
        .firewall-function-card.open {
            box-shadow: 0 8px 28px rgba(0,0,0,0.18);
            transform: translateY(-2px) scale(1.01);
        }
        /* New style for metric-card in IDS section */
        .metric-card {
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 16px 14px 12px 14px;
            color: var(--text-main);
            background: var(--blue2);
            display: flex;
            flex-direction: column;
            gap: 6px;
            min-height: 90px;
        }
        [data-theme="dark"] .metric-card {
            background: var(--blue1);
            color: var(--text-main);
        }
        /* Adjustments for quiz-question cards to match firewall-card */
        .quiz-question .interactive-element {
            cursor: pointer; /* Keep cursor on the interactive element */
            transition: all 0.3s ease; /* Smooth transition for interactivity */
        }
        .quiz-question {
            background: var(--section-bg); /* Match firewall-card background */
            color: var(--text-main); /* Match firewall-card text color */
            box-shadow: var(--shadow); /* Use global shadow variable */
            border-radius: 15px; /* Match firewall-card border-radius */
            padding: 24px 20px 20px 20px; /* Match firewall-card padding */
            margin: 0; /* Remove margin as grid gap will handle spacing */
            transition: all 0.3s ease; /* Add transition for hover effects */
            position: relative; /* For proper positioning of children */
            display: flex; /* Flexbox for internal layout */
            flex-direction: column; /* Stack children vertically */
        }
        /* Remove existing .question class styles that are now redundant or moved */
        .question {
            background: none; /* Remove background */
            color: inherit; /* Inherit color */
            padding: 0; /* Remove padding */
            margin: 0; /* Remove margin */
            border-radius: 0; /* Remove border-radius */
            box-shadow: none; /* Remove box-shadow */
            cursor: default; /* Reset cursor */
            transition: none; /* Remove transition */
        }
        .question-title {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.1em;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-shadow: 0 1px 4px rgba(0,0,0,0.08);
            width: 100%; /* Ensure it takes full width */
        }
        .quiz-question .interactive-element h3 {
            color: var(--primary);
            font-size: clamp(1.05em, 2.2vw, 1.15em); /* Fluid font size */
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 0px; /* Ensure no extra margin */
            width: 100%; /* Ensure it takes full width */
        }

        .quiz-question .interactive-element .toggle-arrow {
            margin-left: auto; /* Push arrow to the right */
            opacity: 0.7;
            transition: opacity 0.2s, transform 0.3s;
            color: inherit; /* Inherit color from parent h3 */
            font-size: 1em; /* Adjust size if needed */
            display: flex;
            align-items: center;
        }

        .quiz-question .interactive-element:hover .toggle-arrow {
            opacity: 1; /* Make arrow more visible on hover */
        }

        .quiz-question .interactive-element.open .toggle-arrow i {
            transform: rotate(180deg);
        }

        .quiz-question .toggle-content ol,
        .quiz-question .toggle-content ul {
            list-style-type: decimal; /* Default for ol */
            padding-left: 20px;
            margin-left: 0;
            margin-top: 10px;
            margin-bottom: 0px;
            font-size: clamp(0.85em, 1.7vw, 0.98em); /* Fluid font size */
            line-height: 1.5;
            font-weight: normal;
            color: var(--text-secondary); /* Ensure text color is visible */
        }

        .quiz-question .toggle-content ul {
            list-style-type: disc; /* Override for ul */
        }

        .quiz-question .toggle-content li {
            margin-bottom: 8px; /* Consistent spacing */
            line-height: 1.6;
        }
        /* New style for screenshot-ready */
        .screenshot-ready .toggle-content,
        .screenshot-ready .function-content,
        .screenshot-ready .limitation-content,
        .screenshot-ready .question-answer {
            max-height: 20000px !important; /* Extremely large value to ensure all content is visible */
            overflow: visible !important;
            margin-top: 10px !important;
            padding: 10px !important;
            transition: none !important; /* Disable transitions during capture */
            display: block !important;
        }

        .screenshot-ready .interactive-element,
        .screenshot-ready .firewall-function-card,
        .screenshot-ready .limitation-card,
        .screenshot-ready .question {
            /* Ensure these parent containers are also visible and don't hide content */
            overflow: visible !important;
        }

        .screenshot-ready .interactive-element.open .toggle-arrow i,
        .screenshot-ready .firewall-function-card.open .function-arrow i,
        .screenshot-ready .limitation-card.open .limitation-arrow i {
            transform: rotate(0deg) !important; /* Reset arrow rotation for consistent look */
        }

        .screenshot-ready .toggle-arrow,
        .screenshot-ready .function-arrow,
        .screenshot-ready .limitation-arrow {
            opacity: 0 !important; /* Hide arrows during capture */
        }

        /* Add new styles for navigation dropdown */
        .nav-dropdown-container {
            display: none; /* Hidden by default */
            width: 100%;
            padding: 0 10px;
        }

        .nav-dropdown {
            width: 100%;
            padding: 12px 20px;
            border-radius: 25px;
            border: 1px solid var(--blue1); /* Softer border */
            background: var(--section-bg); /* Cohesive with other elements */
            color: var(--text-main);
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            /* Updated SVG to use currentColor for fill, making it theme-adaptive */
            background-image: url('data:image/svg+xml;utf8,<svg fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 20px;
            box-shadow: var(--shadow); /* Consistent shadow */
            transition: var(--transition);
        }

        .nav-dropdown:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }

        .nav-dropdown:focus {
            outline: none; /* Remove default outline */
            box-shadow: 0 0 0 3px var(--accent), var(--shadow); /* Attractive focus ring */
        }

        .nav-dropdown option {
            background: var(--nav-bg);
            color: var(--text-main);
            padding: 10px;
        }

        /* Responsive adjustments for navigation */
        @media (max-width: 768px) {
            .nav-buttons {
                display: none; /* Hide original buttons */
            }
            .nav-dropdown-container {
                display: block; /* Show dropdown */
            }
            .navigation {
                padding: 10px; /* Adjust padding for dropdown */
            }
        }

        /* Loading Screen Styles */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(224, 247, 250, 0.8); /* var(--blue2) light with transparency */
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: var(--text-main);
            font-size: 1.5em;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        [data-theme="dark"] .loading-screen {
            background: rgba(34, 47, 62, 0.8); /* var(--blue3) dark with transparency */
            color: var(--text-main);
        }

        .loading-screen.show {
            opacity: 1;
            visibility: visible;
        }

        .loading-spinner {
            border: 8px solid rgba(255, 255, 255, 0.3);
            border-top: 8px solid var(--primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        [data-theme="dark"] .loading-spinner {
            border-top: 8px solid var(--secondary);
        }

        .loading-text {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--text-main); /* Will adapt automatically from var(--text-main) */
            text-shadow: 0 0 8px rgba(0,0,0,0.4);
        }
        [data-theme="dark"] .loading-text {
            text-shadow: 0 0 8px rgba(255,255,255,0.2);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* End Loading Screen Styles */

        .notification {
            position: fixed;
            bottom: 20px;
            left: -400px; /* Start off-screen */
            background: var(--section-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            max-width: 380px;
            z-index: 1000;
            transition: left 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .notification.show {
            left: 20px;
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .notification-title {
            font-weight: bold;
            color: var(--primary);
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2em;
            padding: 5px;
            transition: var(--transition);
        }

        .notification-close:hover {
            color: var(--primary);
            transform: rotate(90deg);
        }

        .notification-content {
            color: var(--text-main);
            font-size: 0.9em;
            line-height: 1.6;
        }

        .notification-content p {
            margin: 8px 0;
        }

        .notification-content .disclaimer {
            font-style: italic;
            opacity: 0.8;
            font-size: 0.9em;
            margin-top: 10px;
        }

        @media (max-width: 480px) {
            .notification {
                max-width: calc(100% - 40px);
                left: -100%;
            }
        }

        .objectives-container {
            background: var(--section-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            color: var(--text-main);
            text-align: left;
        }

        .subsection-title {
            color: var(--primary);
            font-size: clamp(1.2em, 3.5vw, 1.5em); /* Fluid font size */
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid var(--secondary);
            display: flex;
            align-items: center;
        }

        .definition-box {
            background: var(--blue2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            color: var(--text-main);
            text-align: left;
        }

        .objectives-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .objective-card {
            background: var(--primary);
            color: var(--section-bg);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            text-align: left;
            word-break: break-word;
        }
        [data-theme="dark"] .objective-card {
            background: var(--blue1); /* Dark blue background for better contrast */
            color: var(--text-main); /* Light text for dark mode */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); /* Enhanced shadow for dark mode */
        }

        .objective-card h4 {
            font-size: clamp(1.1em, 2.5vw, 1.2em); /* Fluid font size */
            margin-bottom: 10px;
            color: var(--accent);
            text-align: left;
        }

        [data-theme="dark"] .objective-card h4 {
            color: var(--text-main); /* Light color for headings in dark mode */
        }

        .objective-card p {
            font-size: clamp(0.9em, 1.8vw, 1em); /* Fluid font size */
            line-height: 1.6;
            opacity: 0.95;
            color: inherit;
            text-align: left;
        }

        .toggle-content {
            max-height: 0;
            overflow: hidden;
            margin-top: 0; /* Set to 0 when collapsed */
            padding: 0; /* Set to 0 when collapsed */
            background: var(--blue3);
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: max-height 0.3s ease-out, margin-top 0.3s ease-out, padding 0.3s ease-out;
        }
        /* Reset margins/paddings for direct children when collapsed */
        .toggle-content:not(.show) > * {
            margin: 0 !important;
            padding: 0 !important;
            transition: margin 0.3s ease-out, padding 0.3s ease-out; /* Add transition for children's spacing */
        }

        .toggle-content strong {
            color: var(--secondary);
            font-weight: bold;
        }
        .toggle-content.show {
            max-height: 2000px; /* A large value to ensure content fits */
            margin-top: 10px; /* Apply margin when open */
            padding: 10px; /* Apply padding when open */
        }

        .info-vs-network-container {
            background: var(--blue1);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            color: var(--text-main);
            text-align: left;
            margin-top: 32px;
        }

        .info-network-row {
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }

        .info-block {
            flex: 1;
            background: var(--blue2);
            border-radius: 5px;
            padding: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            color: var(--text-main);
            text-align: left;
            word-break: break-word;
        }
        [data-theme="dark"] .info-block {
            background: var(--blue3);
            color: var(--text-main);
        }

        .info-block h4 {
            font-size: clamp(1em, 2vw, 1.1em); /* Fluid font size */
            margin-bottom: 5px;
            color: var(--secondary);
            text-align: left;
        }

        .info-block p {
            font-size: clamp(0.85em, 1.7vw, 0.95em); /* Fluid font size */
            line-height: 1.6;
            opacity: 0.95;
            color: inherit;
            text-align: left;
        }

        .info-block .key-term {
            color: var(--accent);
            font-weight: bold;
        }

        .firewall-functions-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(270px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }

        .firewall-function-card {
            background: linear-gradient(135deg, var(--section-bg) 80%, var(--blue2) 100%);
            border-radius: 14px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.10);
            padding: 22px 20px 14px 20px;
            color: var(--text-main);
            position: relative;
            transition: box-shadow 0.2s, transform 0.2s;
            cursor: pointer;
            min-height: 110px;
            text-align: left;
            border-left: 5px solid var(--primary);
            overflow: hidden;
        }
        [data-theme="dark"] .firewall-function-card {
            background: linear-gradient(135deg, var(--blue3) 80%, var(--blue2) 100%);
            color: var(--text-main);
            border-left: 5px solid var(--secondary);
        }
        .firewall-function-card:hover, .firewall-function-card.open {
            box-shadow: 0 8px 28px rgba(0,0,0,0.18);
            transform: translateY(-2px) scale(1.01);
        }
        .function-title {
            font-size: clamp(1.05em, 2.2vw, 1.18em); /* Fluid font size */
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--primary);
            margin-bottom: 0;
            user-select: none;
            letter-spacing: 0.01em;
        }
        [data-theme="dark"] .function-title {
            color: var(--secondary);
        }
        .function-arrow {
            margin-left: auto;
            opacity: 0;
            transition: opacity 0.2s, transform 0.3s;
            color: var(--primary);
            font-size: 1.18em;
            display: flex;
            align-items: center;
        }
        [data-theme="dark"] .function-arrow {
            color: var(--secondary);
        }
        .firewall-function-card:hover .function-arrow,
        .firewall-function-card.open .function-arrow {
            opacity: 1;
        }
        .firewall-function-card.open .function-arrow i {
            transform: rotate(180deg);
            transition: transform 0.3s;
        }
        .function-content {
            max-height: 0;
            overflow: hidden;
            margin-top: 0;
            padding: 0;
            color: var(--text-main);
            font-size: clamp(0.9em, 1.8vw, 1.04em); /* Fluid font size */
            line-height: 1.7;
            word-break: break-word;
            transition: max-height 0.5s ease-out, margin-top 0.5s ease-out, padding 0.5s ease-out; /* Updated transition to include unified padding */
        }
        /* Reset margins/paddings for direct children when collapsed */
        .firewall-function-card:not(.open) > .function-content > * {
            margin: 0 !important;
            padding: 0 !important;
            transition: margin 0.5s ease-out, padding 0.5s ease-out; /* Add transition for children's spacing */
        }

        [data-theme="dark"] .function-content {
            color: var(--text-main);
        }
        .function-content ul, .function-content ol {
            margin: 10px 0 10px 22px;
            padding-left: 0;
            color: var(--text-main);
            font-size: clamp(0.9em, 1.7vw, 0.98em); /* Fluid font size */
            line-height: 1.6;
        }
        .function-content li {
            margin-bottom: 6px;
            color: var(--text-main);
        }
        .function-content strong {
            color: var(--primary);
        }
        [data-theme="dark"] .function-content strong {
            color: var(--secondary);
        }
        .function-content .key-term {
            color: var(--accent);
            font-weight: bold;
        }

        .firewall-function-card .function-content {
            pointer-events: auto;
        }
        .firewall-function-card.open > .function-content {
            max-height: 2000px; /* A value larger than content will ever be */
            margin-top: 16px; /* Apply margin when open */
            padding: 10px; /* Apply unified padding when open */
        }

        /* CSS for the above sections */
        .firewall-goals-container {
          background: var(--section-bg);
          border-radius: 15px;
          box-shadow: var(--shadow);
          padding: 24px 20px 20px 20px;
          margin-bottom: 28px;
          color: var(--text-main);
        }
        [data-theme="dark"] .firewall-goals-container {
          background: var(--blue3);
          color: var(--text-main);
        }
        .goals-header {
          font-size: clamp(1.1em, 2.2vw, 1.25em); /* Fluid font size */
          font-weight: bold;
          color: var(--primary);
          margin-bottom: 16px;
          display: flex;
          align-items: center;
          gap: 10px;
        }
        [data-theme="dark"] .goals-header {
          color: var(--secondary);
        }
        .goals-list {
          list-style: none;
          padding: 0;
          margin: 0;
        }
        .goal {
          font-size: clamp(1em, 2vw, 1.08em); /* Fluid font size */
          font-weight: bold;
          margin-bottom: 8px;
          padding: 10px 16px;
          border-radius: 8px;
          color: var(--section-bg);
          background: var(--primary);
        }
        .goal-2 { background: var(--secondary); color: var(--text-main); }
        .goal-3 { background: var(--accent); color: var(--text-main); }
        .goal-desc { font-weight: normal; display: block; margin-top: 2px; font-size: clamp(0.9em, 1.7vw, 0.98em); }

        .firewall-techniques-container {
          background: var(--section-bg);
          border-radius: 15px;
          box-shadow: var(--shadow);
          padding: 24px 20px 20px 20px;
          margin-bottom: 28px;
          color: var(--text-main);
        }
        [data-theme="dark"] .firewall-techniques-container {
          background: var(--blue3);
          color: var(--text-main);
        }
        .techniques-header {
          font-size: clamp(1.1em, 2.2vw, 1.25em); /* Fluid font size */
          font-weight: bold;
          color: var(--primary);
          margin-bottom: 16px;
          display: flex;
          align-items: center;
          gap: 10px;
        }
        [data-theme="dark"] .techniques-header {
          color: var(--secondary);
        }
        .techniques-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
          gap: 18px;
        }
        .technique-card {
          border-radius: 10px;
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          padding: 16px 14px 12px 14px;
          color: var(--text-main);
          background: var(--blue2);
          display: flex;
          flex-direction: column;
          gap: 6px;
          min-height: 90px;
        }
        [data-theme="dark"] .technique-card {
          background: var(--blue1);
          color: var(--text-main);
        }
        .technique-service { border-left: 5px solid #4caf50; }
        .technique-direction { border-left: 5px solid #ff9800; }
        .technique-user { border-left: 5px solid #2196f3; }
        .technique-behavior { border-left: 5px solid #e91e63; }
        .technique-title {
          font-size: clamp(1em, 2vw, 1.08em); /* Fluid font size */
          font-weight: bold;
          display: flex;
          align-items: center;
          gap: 8px;
          margin-bottom: 2px;
        }
        .technique-desc {
          font-size: clamp(0.9em, 1.7vw, 0.98em); /* Fluid font size */
          line-height: 1.5;
        }

        .firewall-limitations-container {
          background: var(--section-bg);
          border-radius: 15px;
          box-shadow: var(--shadow);
          padding: 24px 20px 20px 20px;
          margin-bottom: 28px;
          color: var(--text-main);
        }
        [data-theme="dark"] .firewall-limitations-container {
          background: var(--blue3);
          color: var(--text-main);
        }
        .limitations-header {
          font-size: clamp(1.1em, 2.2vw, 1.25em); /* Fluid font size */
          font-weight: bold;
          color: var(--primary);
          margin-bottom: 16px;
          display: flex;
          align-items: center;
          gap: 10px;
        }
        [data-theme="dark"] .limitations-header {
          color: var(--secondary);
        }
        .limitations-list {
          display: flex;
          flex-direction: column;
          gap: 14px;
        }
        .limitation-card {
          background: linear-gradient(90deg, #ffb6b6 60%, #ffd6d6 100%);
          border-radius: 10px;
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          padding: 16px 14px 12px 14px;
          color: #b71c1c;
          font-weight: bold;
          cursor: pointer;
          position: relative;
          transition: box-shadow 0.2s, transform 0.2s;
          min-height: 48px;
          text-align: left;
        }
        [data-theme="dark"] .limitation-card {
          background: linear-gradient(90deg, #b71c1c 60%, #ffb6b6 100%);
          color: var(--section-bg);
        }
        .limitation-title {
          display: flex;
          align-items: center;
          gap: 10px;
          font-size: clamp(1em, 2vw, 1.08em); /* Fluid font size */
          font-weight: bold;
          user-select: none;
        }
        .limitation-arrow {
          margin-left: auto;
          opacity: 0.7;
          color: inherit;
          font-size: 1.1em;
          display: flex;
          align-items: center;
          transition: transform 0.3s;
        }
        .limitation-card.open .limitation-arrow i {
          transform: rotate(180deg);
        }
        .limitation-content {
          display: none;
          margin-top: 10px;
          color: inherit;
          font-size: clamp(0.9em, 1.7vw, 0.98em); /* Fluid font size */
          font-weight: normal;
          line-height: 1.5;
        }
        .limitation-card.open .limitation-content {
          display: block;
          animation: fadeIn 0.3s;
        }
        /* Add this to CSS for uniform goal color */
        .goal-uniform {
          background: var(--primary) !important;
          color: var(--section-bg) !important;
        }
        [data-theme="dark"] .goal-uniform {
          background: var(--primary) !important;
          color: var(--section-bg) !important;
        }

        /* New styles for interactive element arrows */
        .interactive-element h4 {
            position: relative; /* Ensure position for absolute arrow */
        }
        .toggle-arrow {
            margin-left: auto; /* Push arrow to the right */
            opacity: 0.7;
            transition: opacity 0.2s, transform 0.3s;
            color: inherit; /* Inherit color from parent h4 */
            font-size: 1em; /* Adjust size if needed */
            display: flex;
            align-items: center;
        }
        .interactive-element:hover .toggle-arrow {
            opacity: 1; /* Make arrow more visible on hover */
        }
        .interactive-element.open .toggle-arrow i {
            transform: rotate(180deg);
        }
        .firewall-function-card.open {
            box-shadow: 0 8px 28px rgba(0,0,0,0.18);
            transform: translateY(-2px) scale(1.01);
        }
        /* New style for metric-card in IDS section */
        .metric-card {
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 16px 14px 12px 14px;
            color: var(--text-main);
            background: var(--blue2);
            display: flex;
            flex-direction: column;
            gap: 6px;
            min-height: 90px;
        }
        [data-theme="dark"] .metric-card {
            background: var(--blue1);
            color: var(--text-main);
        }
        /* Adjustments for quiz-question cards to match firewall-card */
        .quiz-question .interactive-element {
            cursor: pointer; /* Keep cursor on the interactive element */
            transition: all 0.3s ease; /* Smooth transition for interactivity */
        }
        .quiz-question {
            background: var(--section-bg); /* Match firewall-card background */
            color: var(--text-main); /* Match firewall-card text color */
            box-shadow: var(--shadow); /* Use global shadow variable */
            border-radius: 15px; /* Match firewall-card border-radius */
            padding: 24px 20px 20px 20px; /* Match firewall-card padding */
            margin: 0; /* Remove margin as grid gap will handle spacing */
            transition: all 0.3s ease; /* Add transition for hover effects */
            position: relative; /* For proper positioning of children */
            display: flex; /* Flexbox for internal layout */
            flex-direction: column; /* Stack children vertically */
        }
        /* Remove existing .question class styles that are now redundant or moved */
        .question {
            background: none; /* Remove background */
            color: inherit; /* Inherit color */
            padding: 0; /* Remove padding */
            margin: 0; /* Remove margin */
            border-radius: 0; /* Remove border-radius */
            box-shadow: none; /* Remove box-shadow */
            cursor: default; /* Reset cursor */
            transition: none; /* Remove transition */
        }
        .question-title {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.1em;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-shadow: 0 1px 4px rgba(0,0,0,0.08);
            width: 100%; /* Ensure it takes full width */
        }
        .quiz-question .interactive-element h3 {
            color: var(--primary);
            font-size: clamp(1.05em, 2.2vw, 1.15em); /* Fluid font size */
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 0px; /* Ensure no extra margin */
            width: 100%; /* Ensure it takes full width */
        }

        .quiz-question .interactive-element .toggle-arrow {
            margin-left: auto; /* Push arrow to the right */
            opacity: 0.7;
            transition: opacity 0.2s, transform 0.3s;
            color: inherit; /* Inherit color from parent h3 */
            font-size: 1em; /* Adjust size if needed */
            display: flex;
            align-items: center;
        }

        .quiz-question .interactive-element:hover .toggle-arrow {
            opacity: 1; /* Make arrow more visible on hover */
        }

        .quiz-question .interactive-element.open .toggle-arrow i {
            transform: rotate(180deg);
        }

        .quiz-question .toggle-content ol,
        .quiz-question .toggle-content ul {
            list-style-type: decimal; /* Default for ol */
            padding-left: 20px;
            margin-left: 0;
            margin-top: 10px;
            margin-bottom: 0px;
            font-size: clamp(0.85em, 1.7vw, 0.98em); /* Fluid font size */
            line-height: 1.5;
            font-weight: normal;
            color: var(--text-secondary); /* Ensure text color is visible */
        }

        .quiz-question .toggle-content ul {
            list-style-type: disc; /* Override for ul */
        }

        .quiz-question .toggle-content li {
            margin-bottom: 8px; /* Consistent spacing */
            line-height: 1.6;
        }
        /* New style for screenshot-ready */
        .screenshot-ready .toggle-content,
        .screenshot-ready .function-content,
        .screenshot-ready .limitation-content,
        .screenshot-ready .question-answer {
            max-height: 20000px !important; /* Extremely large value to ensure all content is visible */
            overflow: visible !important;
            margin-top: 10px !important;
            padding: 10px !important;
            transition: none !important; /* Disable transitions during capture */
            display: block !important;
        }

        .screenshot-ready .interactive-element,
        .screenshot-ready .firewall-function-card,
        .screenshot-ready .limitation-card,
        .screenshot-ready .question {
            /* Ensure these parent containers are also visible and don't hide content */
            overflow: visible !important;
        }

        .screenshot-ready .interactive-element.open .toggle-arrow i,
        .screenshot-ready .firewall-function-card.open .function-arrow i,
        .screenshot-ready .limitation-card.open .limitation-arrow i {
            transform: rotate(0deg) !important; /* Reset arrow rotation for consistent look */
        }

        .screenshot-ready .toggle-arrow,
        .screenshot-ready .function-arrow,
        .screenshot-ready .limitation-arrow {
            opacity: 0 !important; /* Hide arrows during capture */
        }

        /* Add new styles for navigation dropdown */
        .nav-dropdown-container {
            display: none; /* Hidden by default */
            width: 100%;
            padding: 0 10px;
        }

        .nav-dropdown {
            width: 100%;
            padding: 12px 20px;
            border-radius: 25px;
            border: 1px solid var(--blue1); /* Softer border */
            background: var(--section-bg); /* Cohesive with other elements */
            color: var(--text-main);
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            /* Updated SVG to use currentColor for fill, making it theme-adaptive */
            background-image: url('data:image/svg+xml;utf8,<svg fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 20px;
            box-shadow: var(--shadow); /* Consistent shadow */
            transition: var(--transition);
        }

        .nav-dropdown:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }

        .nav-dropdown:focus {
            outline: none; /* Remove default outline */
            box-shadow: 0 0 0 3px var(--accent), var(--shadow); /* Attractive focus ring */
        }

        .nav-dropdown option {
            background: var(--nav-bg);
            color: var(--text-main);
            padding: 10px;
        }

        /* Responsive adjustments for navigation */
        @media (max-width: 768px) {
            .nav-buttons {
                display: none; /* Hide original buttons */
            }
            .nav-dropdown-container {
                display: block; /* Show dropdown */
            }
            .navigation {
                padding: 10px; /* Adjust padding for dropdown */
            }
        }

    </style>
</head>
<body>
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p class="loading-text">Preparing your image...</p>
    </div>
    <div class="container">
        <div class="header">
            <div class="theme-toggle">
                <div class="toggle-switch" id="themeSwitch">
                    <div class="toggle-slider">
                        <span class="icon-sun"><i class="fas fa-sun"></i></span>
                        <span class="icon-moon"><i class="fas fa-moon"></i></span>
                    </div>
                </div>
            </div>
            <h1><i class="fas fa-shield-alt"></i> Data Security Learning Module</h1>
            <p>Firewalls & Intrusion Detection Systems</p>
            <p>Created By Eng. Eslam Osama</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <div class="download-buttons">
                <button class="download-btn" onclick="downloadWordFile()">
                    <i class="fas fa-file-word"></i> Download Original Sheet
                </button>
                <button class="download-btn" onclick="downloadFullPageZip()">
                    <i class="fas fa-file-zip-o"></i> Download Content (ZIP)
                </button>
            </div>
        </div>

        <div class="navigation">
            <div class="nav-buttons">
                <button class="nav-btn active" data-section="objectives">
                    <i class="fas fa-bullseye"></i> Security Objectives
                </button>
                <button class="nav-btn" data-section="firewalls">
                    <i class="fas fa-fire"></i> Firewalls
                </button>
                <button class="nav-btn" data-section="firewall-types">
                    <i class="fas fa-network-wired"></i> Firewall Types
                </button>
                <button class="nav-btn" data-section="dmz">
                    <i class="fas fa-chess-board"></i> DMZ Networks
                </button>
                <button class="nav-btn" data-section="ids">
                    <i class="fas fa-eye"></i> Intrusion Detection
                </button>
                <button class="nav-btn" data-section="quiz">
                    <i class="fas fa-question-circle"></i> Review Questions
                </button>
            </div>
            <!-- New dropdown for small screens -->
            <div class="nav-dropdown-container">
                <select id="navDropdown" class="nav-dropdown">
                    <option value="objectives">Security Objectives</option>
                    <option value="firewalls">Firewalls</option>
                    <option value="firewall-types">Firewall Types</option>
                    <option value="dmz">DMZ Networks</option>
                    <option value="ids">Intrusion Detection</option>
                    <option value="quiz">Review Questions</option>
                </select>
            </div>
        </div>

        <!-- Security Objectives Section -->
        <div id="objectives" class="section active objectives-container">
            <h2 class="section-title">Security Objectives
                <button class="download-section-btn" onclick="downloadSectionPng(this)">
                    <i class="fas fa-download"></i>
                </button>
            </h2>
            <div class="definition-box">
                <p>Before diving into firewalls and IDS, it's crucial to understand the fundamental goals of information security:</p>
            </div>
            <div class="objectives-list">
                <div class="objective-card obj-conf">
                    <h4><i class="fas fa-lock"></i> Confidentiality</h4>
                    <p>Protection of data from unauthorized disclosure.</p>
                </div>
                <div class="objective-card obj-int">
                    <h4><i class="fas fa-check-circle"></i> Integrity</h4>
                    <p>Assurance that data received is as sent by an authorized entity.</p>
                </div>
                <div class="objective-card obj-avail">
                    <h4><i class="fas fa-sync-alt"></i> Availability</h4>
                    <p>Assures that systems work promptly and service is not denied to authorized users.</p>
                </div>
                <div class="objective-card obj-auth">
                    <h4><i class="fas fa-user-check"></i> Authenticity</h4>
                    <p>The property of being genuine/able to be verified/trusted/confidence in the validity of a transmission/message/message originator.</p>
                </div>
                <div class="objective-card obj-acc">
                    <h4><i class="fas fa-clipboard-list"></i> Accountability</h4>
                    <p>The security goal that generates the requirement for actions of an entity to be traced uniquely.</p>
                </div>
            </div>
            <div class="info-vs-network-container">
                <h3 class="subsection-title">Information Security vs Network Security</h3>
                <div class="info-network-row">
                    <div class="info-block info-block-info">
                        <h4><i class="fas fa-info-circle"></i> Information Security</h4>
                        <p>Information security means protecting data so that only the right people can access it (<span class="key-term">confidentiality</span>), it stays accurate and unchanged (<span class="key-term">integrity</span>), and it's available when needed (<span class="key-term">availability</span>). It also includes user's identity can be identified (<span class="key-term">authenticity</span>), actions can be tracked (<span class="key-term">accountability</span>), no one can deny their actions (<span class="key-term">non-repudiation</span>), and the system works reliably.</p>
                    </div>
                    <div class="info-block info-block-network">
                        <h4><i class="fas fa-network-wired"></i> Network Security</h4>
                        <p>Network security focuses on protecting networks and their devices from unauthorized access, changes, or damage. It ensures that data can move safely through the network and that everything connected (like routers or servers) works correctly and securely without causing harm or being exposed to threats.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Firewalls Section -->
        <div id="firewalls" class="section" style="padding-bottom: 5px;">
            <h2 class="section-title">Firewalls
                <button class="download-section-btn" onclick="downloadSectionPng(this)">
                    <i class="fas fa-download"></i>
                </button>
            </h2>
            
            <div class="subsection" style="margin-bottom: 0px;">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-question-circle"></i> What is a Firewall?</h3>
                    <p style="color: var(--text-main); margin-bottom: 0px; line-height: 1.6;">A firewall is like a <span class="key-term">security gate</span> that controls what data can go in or out of your network. It helps protect your internal network from the dangers of the internet and is often the first layer of defense.</p>
                    <div class="image-placeholder" style="background: none; border: none; box-shadow: none; padding: 0; margin: 20px auto 60px auto; display: flex; justify-content: center; align-items: center; max-width: 800px;">
                        <img src="media/image1.png" alt="Firewall" style="width: auto; height: auto; max-width: 100%; object-fit: contain; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);" />
                    </div>
                </div>
            </div>

            <div class="subsection" style="margin-top: 30px;">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-tasks"></i> Main Purposes and Functions of Firewalls</h3>
                    <div class="firewall-functions-list" style="margin-top: 18px;">
                        <div class="firewall-function-card">
                            <div class="function-title"><i class="fas fa-filter"></i> Network Traffic Filtering <span class="function-arrow"><i class="fas fa-chevron-down"></i></span></div>
                            <div class="function-content">
                                <p>Firewalls control what data enters or leaves a network by checking each packet against a set of rules. They filter traffic based on details like:</p>
                                <ul>
                                    <li>Source IP address (where it's coming from)</li>
                                    <li>Destination IP address (where it's going)</li>
                                    <li>Port numbers (type of service like web or email)</li>
                                    <li>Protocols (like TCP or UDP)</li>
                                </ul>
                                <p>This helps block unwanted or harmful traffic and only allows approved connections to pass through.</p>
                            </div>
                        </div>
                        <div class="firewall-function-card">
                            <div class="function-title"><i class="fas fa-user-lock"></i> Access Control <span class="function-arrow"><i class="fas fa-chevron-down"></i></span></div>
                            <div class="function-content">
                                <p>Firewalls help control who can access your network by using <span class="key-term">predefined rules</span>, which are settings created by network administrators to decide what is allowed or blocked. These rules tell the firewall to either permit or deny network connections based on things like IP addresses, ports, or types of services.</p>
                            </div>
                        </div>
                        <div class="firewall-function-card">
                            <div class="function-title"><i class="fas fa-exchange-alt"></i> Network Address Translation (NAT) <span class="function-arrow"><i class="fas fa-chevron-down"></i></span></div>
                            <div class="function-content">
                                <p>NAT lets many devices (like phones, laptops, smart devices) <span class="key-term">inside your private network</span> use <span class="key-term">one public IP address</span> to connect to the internet.</p>
                                <strong>Purpose:</strong>
                                <ul>
                                    <li>Hides internal IP addresses from the outside world for extra security</li>
                                    <li>Helps the firewall control traffic coming in and going out</li>
                                </ul>
                                <strong>How It Works:</strong>
                                <ol>
                                    <li>You have a router/firewall with NAT</li>
                                    <li>Inside your network: devices use private IP addresses</li>
                                    <li>When devices access internet, NAT changes the private IP into the public IP of the router</li>
                                    <li>It keeps track of the requests, so when the response comes back, it knows which internal device should get it (using translation table)</li>
                                </ol>
                            </div>
                        </div>
                        <div class="firewall-function-card">
                            <div class="function-title"><i class="fas fa-virus"></i> Threat Prevention <span class="function-arrow"><i class="fas fa-chevron-down"></i></span></div>
                            <div class="function-content">
                                <p>Firewalls provide protection against various network threats, such as malware, viruses, and intrusion attempts.</p>
                            </div>
                        </div>
                        <div class="firewall-function-card">
                            <div class="function-title"><i class="fas fa-laptop-house"></i> VPN and Remote Access Security <span class="function-arrow"><i class="fas fa-chevron-down"></i></span></div>
                            <div class="function-content">
                                <p>Firewalls often support VPNs (Virtual Private Networks), which allow users to safely connect to a private network from a remote location (like from home or while traveling). A VPN encrypts the connection, keeping data private and secure from hackers, especially on public Wi-Fi. Firewalls help control and protect these remote connections by only allowing trusted users to access the network.</p>
                            </div>
                        </div>
                        <div class="firewall-function-card">
                            <div class="function-title"><i class="fas fa-clipboard-list"></i> Logging and Auditing <span class="function-arrow"><i class="fas fa-chevron-down"></i></span></div>
                            <div class="function-content">
                                <p>Firewalls maintain logs of network traffic and security events. These logs can be used for monitoring and auditing purposes.</p>
                            </div>
                        </div>
                        <div class="firewall-function-card">
                            <div class="function-title"><i class="fas fa-radar"></i> Intrusion Detection and Prevention (IDPS) <span class="function-arrow"><i class="fas fa-chevron-down"></i></span></div>
                            <div class="function-content">
                                <p>It is a security feature that <span class="key-term">monitors</span> network traffic to <span class="key-term">detect</span> and <span class="key-term">stop attacks or suspicious activity</span> in real time and also <span class="key-term">Alert admins</span>, so they know something suspicious is happening.</p>
                            </div>
                        </div>
                        <div class="firewall-function-card">
                            <div class="function-title"><i class="fas fa-object-group"></i> Virtual Segmentation <span class="function-arrow"><i class="fas fa-chevron-down"></i></span></div>
                            <div class="function-content">
                                <p>Means <span class="key-term">splitting a big network into smaller, separate zones or sections</span> using a firewall. Each section is like a "mini-network" inside the main one.</p>
                                <br>
                                <strong>Purpose:</strong>
                                <ul>
                                    <li><strong>Better security:</strong> Keep sensitive parts (like servers or admin systems) separate from general user traffic</li>
                                    <li><strong>Limit damage:</strong> If a hacker gets into one zone, they can't easily move to other zones</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="subsection">
                <!-- Design Goals for a Firewall -->
                <div class="firewall-goals-container">
                  <div class="goals-header"><i class="fas fa-bullseye"></i> Design Goals for a Firewall</div>
                  <ol class="goals-list">
                    <li class="goal goal-1 goal-uniform"><span>1. All traffic from inside to outside, and vice versa, must pass through the firewalls.</span></li>
                    <li class="goal goal-2 goal-uniform"><span>2. Only authorized traffic, as defined by the local security policy and rules, will be allowed to pass.</span></li>
                    <li class="goal goal-3 goal-uniform"><span>3. The firewall itself is immune to penetration.</span> <span class="goal-desc">This implies the use of a hardened system with a secured operating system (OS).</span></li>
                  </ol>
                </div>

                <div class="subsection">
                    <div class="firewall-techniques-container">
                      <div class="techniques-header"><i class="fas fa-cogs"></i> Firewall Techniques</div>
                      <div class="techniques-grid">
                        <div class="technique-card technique-service">
                          <div class="technique-title"><i class="fas fa-cog"></i> Service Control</div>
                          <div class="technique-desc">Decides which Internet services (like email, web browsing, or file sharing) are allowed to enter or leave the network.</div>
                        </div>
                        <div class="technique-card technique-direction">
                          <div class="technique-title"><i class="fas fa-directions"></i> Direction Control</div>
                          <div class="technique-desc">Controls whether service requests can flow <b>into</b> the network, <b>out of</b> the network, or both.</div>
                        </div>
                        <div class="technique-card technique-user">
                          <div class="technique-title"><i class="fas fa-users-cog"></i> User Control</div>
                          <div class="technique-desc">Controls access to a service according to which user is attempting to access it. This feature is typically applied to local users inside the firewall perimeter.</div>
                        </div>
                        <div class="technique-card technique-behavior">
                          <div class="technique-title"><i class="fas fa-chart-line"></i> Behavior Control</div>
                          <div class="technique-desc">Manages how certain services are used, such as limiting how much data can be transferred or which features of a service can be accessed.</div>
                        </div>
                      </div>
                    </div>
                </div>

                <div class="subsection">
                    <div class="firewall-limitations-container">
                      <div class="limitations-header"><i class="fas fa-exclamation-triangle"></i> Firewall Limitations</div>
                      <div class="limitations-list">
                        <div class="limitation-card">
                          <div class="limitation-title"><i class="fas fa-door-open"></i> 1. Bypass Attacks <span class="limitation-arrow"><i class="fas fa-chevron-down"></i></span></div>
                          <div class="limitation-content">If attackers find a way around the firewall (like using an unprotected network path), the firewall can't stop them.</div>
                        </div>
                        <div class="limitation-card">
                          <div class="limitation-title"><i class="fas fa-user-secret"></i> 2. Internal Threats <span class="limitation-arrow"><i class="fas fa-chevron-down"></i></span></div>
                          <div class="limitation-content">Firewalls don't fully protect against people inside the company who might cause harm, whether on purpose or by accident.</div>
                        </div>
                        <div class="limitation-card">
                          <div class="limitation-title"><i class="fas fa-wifi"></i> 3. Wireless Network Risks <span class="limitation-arrow"><i class="fas fa-chevron-down"></i></span></div>
                          <div class="limitation-content">If the company's wireless network isn't secured well, outsiders might connect to it and cause problems.</div>
                        </div>
                        <div class="limitation-card">
                          <div class="limitation-title"><i class="fas fa-laptop-medical"></i> 4. Infected Devices <span class="limitation-arrow"><i class="fas fa-chevron-down"></i></span></div>
                          <div class="limitation-content">Devices like laptops or smartphones can get viruses or malware outside the company, and when brought back inside, they can infect the internal network.</div>
                        </div>
                      </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Firewall Types Section -->
        <div id="firewall-types" class="section">
            <h2 class="section-title">Types of Firewalls
                <button class="download-section-btn" onclick="downloadSectionPng(this)">
                    <i class="fas fa-download"></i>
                </button>
            </h2>
            
            <div class="subsection">
                <div class="firewall-types">
                    <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                        <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-box"></i> 1. Packet Filtering Firewall</h3>
                        <p>A network security tool that checks each data packet and decides if it should be <span class="key-term">allowed</span> or <span class="key-term">blocked</span>, based on <span class="key-term">rules</span>. It works on Network layer to handles IP addresses and Transport layer to handles port numbers and protocols.</p>
                        
                        <div class="image-placeholder" style="background: none; border: none; box-shadow: none; padding: 0; margin: 20px auto 60px auto; display: flex; justify-content: center; align-items: center; max-width: 800px;">
                            <i class="fas fa-filter pulse"></i>
                            <p>Packet Filtering Firewall Diagram</p>

                            <div class="card-image">
                                <img src="media/image2.png" alt="Packet Filtering Firewall" style="width: 80%; height: auto; object-fit: contain; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                            </div>
                        </div>
                        
                        <div style="background: var(--blue2); border-radius: 10px; padding: 15px 20px; margin-top: 20px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);">
                            <h4 style="color: var(--primary); font-size: 1.2em; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-search"></i> What it looks at:</h4>
                            <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                <li style="margin-bottom: 8px; line-height: 1.5; display: flex; align-items: center; gap: 8px;"><i class="fas fa-circle-notch" style="font-size: 0.7em; color: var(--secondary);"></i> <strong>Source IP address</strong> - where the packet comes from</li>
                                <li style="margin-bottom: 8px; line-height: 1.5; display: flex; align-items: center; gap: 8px;"><i class="fas fa-circle-notch" style="font-size: 0.7em; color: var(--secondary);"></i> <strong>Destination IP address</strong> - where the packet is going</li>
                                <li style="margin-bottom: 8px; line-height: 1.5; display: flex; align-items: center; gap: 8px;"><i class="fas fa-circle-notch" style="font-size: 0.7em; color: var(--secondary);"></i> <strong>Port numbers</strong> - what type of service is being used (like web or email)</li>
                                <li style="margin-bottom: 0px; line-height: 1.5; display: flex; align-items: center; gap: 8px;"><i class="fas fa-circle-notch" style="font-size: 0.7em; color: var(--secondary);"></i> <strong>Protocol</strong> - like TCP, UDP, or ICMP</li>
                            </ul>
                        </div>
                        
                        <div class="pros-cons" style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 25px;">
                            <div class="pros" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h5 style="color: var(--primary); font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-check-circle"></i> Advantages</h5>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Simple and easy to configure</li>
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Fast and uses fewer resources</li>
                                    <li style="margin-bottom: 0px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Good for basic protection</li>
                                </ul>
                            </div>
                            <div class="cons" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h5 style="color: #E57373; font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-times-circle"></i> Disadvantages</h5>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Only checks basic info (IP, port)</li>
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Can't see what's inside the packet content</li>
                                    <li style="margin-bottom: 0px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Can't detect complex attacks or viruses</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                        <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-brain"></i> 2. Stateful Inspection Firewall</h3>
                        <p>A smart type of firewall that not only looks at each packet (similar to <strong>Packet Filtering Firewall</strong>) but also <span class="key-term">remembers previous packets</span> and the <span class="key-term">state of the connection</span>. It works on Network layer to handles IP addresses, Transport layer to handles port numbers and protocols, and state awareness to keeps track of connection status.</p>
                        
                        <div class="image-placeholder" style="background: none; border: none; box-shadow: none; padding: 0; margin: 20px auto 60px auto; display: flex; justify-content: center; align-items: center; max-width: 800px;">
                            <i class="fas fa-history pulse"></i>
                            <p>Stateful Inspection Diagram</p>
                            <div class="card-image">
                                <img src="media/image3.png" alt="Packet Filtering Firewall" style="width: 80%; height: auto; object-fit: contain; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                            </div>
                        </div>
                        
                        <div class="pros-cons" style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 25px;">
                            <div class="pros" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h5 style="color: var(--primary); font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-check-circle"></i> Advantages</h5>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Smarter and more secure than basic packet filtering</li>
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Can stop packets that are out of place or fake</li>
                                    <li style="margin-bottom: 0px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Tracks entire connections, not just individual packets</li>
                                </ul>
                            </div>
                            <div class="cons" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h5 style="color: #E57373; font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-times-circle"></i> Disadvantages</h5>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> More complex to configure</li>
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Uses more system resources</li>
                                    <li style="margin-bottom: 0px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Might slow down performance slightly in big networks</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                        <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-user-shield"></i> 3. Application-Level Gateway (ALG)</h3>
                        <p>A <span class="key-term">type of firewall</span> that acts like a <span class="key-term">security middleman</span> between users and web servers as it <span class="key-term">inspects</span> and <span class="key-term">filters</span> traffic at the <span class="key-term">Application Layer</span>.</p>
                        
                        <div class="image-placeholder" style="background: none; border: none; box-shadow: none; padding: 0; margin: 20px auto 60px auto; display: flex; justify-content: center; align-items: center; max-width: 800px;">
                            <i class="fas fa-user-friends pulse"></i>
                            <p>ALG Diagram</p>
                            <div class="card-image">
                                <img src="media/image4.png" alt="Packet Filtering Firewall" style="width: 80%; height: auto; object-fit: contain; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                            </div>
                        </div>
                        
                        <div class="interactive-element" data-toggle="alg-work" style="background: var(--blue2); border-radius: 10px; padding: 15px 20px; margin-top: 20px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); cursor: pointer; transition: all 0.3s ease;">
                            <h4 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-cogs"></i> How it Works <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h4>
                            <div class="toggle-content" id="alg-work" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                <ol style="list-style-type: decimal; padding-left: 20px; margin-left: 0; margin-top: 10px; margin-bottom: 0px;">
                                    <li style="margin-bottom: 8px; font-size: 0.98em; line-height: 1.5; font-weight: normal;">User sends a request (e.g., to visit a website)</li>
                                    <li style="margin-bottom: 8px; font-size: 0.98em; line-height: 1.5; font-weight: normal;">The ALG <strong>receives the request first</strong></li>
                                    <li style="margin-bottom: 8px; font-size: 0.98em; line-height: 1.5; font-weight: normal;">It <strong>analyzes</strong> the content based on the application's protocol like HTTP</li>
                                    <li style="margin-bottom: 8px; font-size: 0.98em; line-height: 1.5; font-weight: normal;">If the content is safe, it <strong>forwards the request</strong> to the real destination</li>
                                    <li style="margin-bottom: 0px; font-size: 0.98em; line-height: 1.5; font-weight: normal;">It can <strong>block, modify, or log</strong> requests if they are harmful or restricted</li>
                                </ol>
                            </div>
                        </div>
                        
                        <div class="pros-cons" style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 25px;">
                            <div class="pros" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h5 style="color: var(--primary); font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-check-circle"></i> Advantages</h5>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> High security -- understands app-level threats</li>
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Can analyze data deeply (like URLs, keywords, file types)</li>
                                    <li style="margin-bottom: 0px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Can enforce policies (e.g., block certain sites, limit uploads)</li>
                                </ul>
                            </div>
                            <div class="cons" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h5 style="color: #E57373; font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-times-circle"></i> Disadvantages</h5>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Slower than other firewalls because of deep inspection</li>
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> More complex to set up and manage</li>
                                    <li style="margin-bottom: 0px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Not suitable for untrusted external communications</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                        <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-exchange-alt"></i> 4. Circuit-Level Gateway</h3>
                        <p>A <span class="key-term">type of firewall</span> that works at the <span class="key-term">Transport Layer</span> to control network connections. It <span class="key-term">doesn't inspect the content</span> of traffic, just makes sure the connection (like a TCP handshake) is valid.</p>
                        
                        <div class="image-placeholder" style="background: none; border: none; box-shadow: none; padding: 0; margin: 20px auto 60px auto; display: flex; justify-content: center; align-items: center; max-width: 800px;">
                            <i class="fas fa-link pulse"></i>
                            <p>Circuit-Level Gateway Diagram</p>
                            <div class="card-image">
                                <img src="media/image5.png" alt="Packet Filtering Firewall" style="width: 80%; height: auto; object-fit: contain; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                            </div>
                        </div>
                        
                        <div class="interactive-element" data-toggle="circuit-work" style="background: var(--blue2); border-radius: 10px; padding: 15px 20px; margin-top: 20px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); cursor: pointer; transition: all 0.3s ease;">
                            <h4 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-cogs"></i> How it Works <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h4>
                            <div class="toggle-content" id="circuit-work" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                <ol style="list-style-type: decimal; padding-left: 20px; margin-left: 0; margin-top: 10px; margin-bottom: 0px;">
                                    <li style="margin-bottom: 8px; font-size: 0.98em; line-height: 1.5; font-weight: normal;">A user inside the network wants to connect to an outside server (e.g., a website)</li>
                                    <li style="margin-bottom: 8px; font-size: 0.98em; line-height: 1.5; font-weight: normal;">The Circuit-Level Gateway <strong>creates two connections</strong>:
                                        <ul style="list-style-type: disc; padding-left: 20px; margin-top: 8px; margin-bottom: 0px;">
                                            <li style="margin-bottom: 4px; font-size: 0.95em; line-height: 1.5; font-weight: normal;">One between the <strong>user and the gateway</strong></li>
                                            <li style="margin-bottom: 0px; font-size: 0.95em; line-height: 1.5; font-weight: normal;">One between the <strong>gateway and the external server</strong></li>
                                        </ul>
                                    </li>
                                    <li style="margin-bottom: 8px; font-size: 0.98em; line-height: 1.5; font-weight: normal;">The gateway <strong>forwards traffic</strong> between both connections</li>
                                    <li style="margin-bottom: 0px; font-size: 0.98em; line-height: 1.5; font-weight: normal;">It <strong>monitors the session setup only</strong>, not the actual data</li>
                                </ol>
                            </div>
                        </div>
                        
                        <div class="pros-cons" style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 25px;">
                            <div class="pros" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h5 style="color: var(--primary); font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-check-circle"></i> Advantages</h5>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Faster than deep-inspection firewalls</li>
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Low resource use -- doesn't slow down the network</li>
                                    <li style="margin-bottom: 0px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Simple setup, ideal for trusted internal users</li>
                                </ul>
                            </div>
                            <div class="cons" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h5 style="color: #E57373; font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-times-circle"></i> Disadvantages</h5>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Doesn't inspect data -- can't detect malware or harmful content</li>
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Not suitable for untrusted external communications</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- DMZ Section -->
        <div id="dmz" class="section">
            <h2 class="section-title">Demilitarized Zone (DMZ) Networks
                <button class="download-section-btn" onclick="downloadSectionPng(this)">
                    <i class="fas fa-download"></i>
                </button>
            </h2>
            
            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-question-circle"></i> What is a DMZ?</h3>
                    <p>A <span class="key-term">DMZ</span> (Demilitarized Zone) is a <span class="key-term">special zone</span> in a network that sits <span class="key-term">between the internal network (LAN)</span> and the <span class="key-term">external internet (WAN)</span>. It acts as a <span class="key-term">buffer zone</span> for hosting public services (like websites) while <span class="key-term">protecting the internal network</span>.</p>
                    
                    <div class="image-placeholder" style="background: none; border: none; box-shadow: none; padding: 0; margin: 20px auto 60px auto; display: flex; justify-content: center; align-items: center; max-width: 800px;">
                        <i class="fas fa-chess-board pulse"></i>
                        <p>DMZ Network Diagram</p>
                        <div class="card-image">
                            <img src="media/image6.png" alt="Packet Filtering Firewall" style="width: 80%; height: auto; object-fit: contain; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        </div>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <div class="interactive-element" data-toggle="dmz-purpose">
                        <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-bullseye"></i> Purpose of DMZ <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                        <div class="toggle-content" id="dmz-purpose">
                            <ul>
                                <li>To <strong>host public services</strong> (that anyone on the internet can access), <strong>without exposing the entire internal network</strong> to risks</li>
                                <li>If someone attacks a server in the DMZ, they still <strong>can't reach the sensitive internal network</strong> directly</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <div class="interactive-element" data-toggle="dmz-benefits">
                        <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-check-circle"></i> Benefits of DMZ <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                        <div class="toggle-content" id="dmz-benefits">
                            <ul>
                                <li>Adds <strong>an extra layer of protection</strong> between public services and internal systems</li>
                                <li>Allows <strong>safe public access</strong> to things like company websites or email servers</li>
                                <li>Keeps <strong>private resources hidden</strong> from external threats</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-server"></i> Typical DMZ Services</h3>
                    <div class="firewall-types" style="margin-top: 18px; display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 24px;">
                        <div class="firewall-card">
                            <h4 style="color: var(--primary); font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-globe"></i> Web Servers</h4>
                            <p>Host company websites accessible to the public</p>
                        </div>
                        <div class="firewall-card">
                            <h4 style="color: var(--primary); font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-envelope"></i> Email Servers</h4>
                            <p>Handle incoming and outgoing email communications</p>
                        </div>
                        <div class="firewall-card">
                            <h4 style="color: var(--primary); font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-signature"></i> DNS Servers</h4>
                            <p>Resolve domain names for external users</p>
                        </div>
                        <div class="firewall-card">
                            <h4 style="color: var(--primary); font-size: 1.15em; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-file-export"></i> FTP Servers</h4>
                            <p>Allow file transfers with external parties</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- IDS Section -->
        <div id="ids" class="section">
            <h2 class="section-title">Intrusion Detection Systems (IDS)
                <button class="download-section-btn" onclick="downloadSectionPng(this)">
                    <i class="fas fa-download"></i>
                </button>
            </h2>
            
            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-question-circle"></i> What is an IDS?</h3>
                    <p>It is a <span class="key-term">hardware or software solution</span> that <span class="key-term">monitors</span>, <span class="key-term">gathers</span>, and <span class="key-term">analyzes</span> information from a <span class="key-term">computer system or network</span> to detect and <span class="key-term">alert</span> about unauthorized or suspicious attempts to access, misuse, or compromise system resources.</p>
                    
                    <div class="objective-card" style="margin-top: 18px; background: var(--blue2);">
                        <h4 style="color: var(--primary); font-size: 1.2em; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-bullhorn"></i> Key Functions: Monitoring, Detecting, and Alerting</h4>
                        <p style="font-size: 1em; line-height: 1.6; opacity: 0.95; color: var(--text-main); text-align: left;"><strong>Note:</strong> IDS is a <span class="key-term">passive system</span> as it <span class="key-term">does not block attacks</span>, only <span class="key-term">detects and alerts</span>.</p>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <div class="interactive-element" data-toggle="intrusion-def">
                        <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-exclamation-triangle"></i> What is an Intrusion? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                        <div class="toggle-content" id="intrusion-def">
                            <p>Any <strong>violation of security policies</strong>, whether by <strong>external attackers</strong> or <strong>internal authorized users</strong>, that threatens:</p>
                            <ul>
                                <li><strong>Confidentiality</strong> (unauthorized access to data)</li>
                                <li><strong>Integrity</strong> (unauthorized modification of data)</li>
                                <li><strong>Availability</strong> (disruption of service)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <div class="interactive-element" data-toggle="intrusion-detection">
                        <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-search"></i> What is Intrusion Detection? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                        <div class="toggle-content" id="intrusion-detection">
                            <p>The <strong>process of monitoring and analyzing</strong> system or network activities to <strong>identify signs of intrusions</strong> or policy violations.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-layer-group"></i> Types of Intrusion Detection Systems</h3>
                    
                    <div class="pros-cons" style="margin-top: 18px; display: flex; flex-wrap: wrap; gap: 20px;">
                        <div class="pros" style="background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                            <h3 style="color: var(--primary); font-size: 1.25em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-desktop"></i> Host-Based IDS (HIDS)</h3>
                            <p>Monitors activities on <strong>individual devices</strong> like computers or servers as it keeps an eye on system files, logs, and applications to spot any unusual behavior or unauthorized changes.</p>
                            <br>
                            <strong>Example:</strong> If someone tries to alter important system files on a web server, HIDS will detect this and alert the administrator.
                        </div>
                        <div class="cons" style="background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                            <h3 style="color: var(--primary); font-size: 1.25em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-network-wired"></i> Network-Based IDS (NIDS)</h3>
                            <p>Watches over the <strong>entire network's traffic</strong> to identify suspicious activities as it analyzes data packets moving across the network to detect patterns that match known threats or anomalies.</p>
                            <br>
                            <strong>Example:</strong> DOS attack on the service server in the network, NIDS will recognize this and send an alert to firewall to stop these requests.
                        </div>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-puzzle-piece"></i> IDS Logical Components</h3>
                    <div class="firewall-types" style="margin-top: 18px; display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 24px;">
                        <div class="firewall-card">
                            <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-satellite-dish"></i> Sensors</h3>
                            <p>Responsible for <strong>collecting data</strong> from various sources in the system or network.</p>
                        </div>
                        <div class="firewall-card">
                            <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-brain"></i> Analyzers</h3>
                            <p>Receive input from sensors and are responsible for <strong>determining if an intrusion has occurred</strong>.</p>
                        </div>
                        <div class="firewall-card">
                            <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-tv"></i> User Interface</h3>
                            <p>Enables a user to <strong>view output from the system</strong> or <strong>control its behavior</strong>.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-search-plus"></i> IDS Detection Techniques</h3>
                    
                    <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                        <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-fingerprint"></i> 1. Misuse Detection (Signature-Based)</h3>
                        <p>Compares incoming data to a <span class="key-term">database of known attack patterns (signatures)</span>. If a match is found, an alert is triggered.</p>
                        
                        <div class="analogy-content" style="background: var(--blue2); border-radius: 10px; padding: 15px 20px; margin-top: 20px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);">
                            <h4 style="color: var(--primary); font-size: 1.15em; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-lightbulb"></i> Analogy</h4>
                            <p>Like a security guard checking IDs against a list of known criminals.</p>
                        </div>
                        
                        <div class="pros-cons" style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 25px;">
                            <div class="pros" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h3 style="color: var(--primary); font-size: 1.25em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-check"></i> Advantages</h3>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Quick and accurate detection of known threats</li>
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Low false positive rates</li>
                                </ul>
                            </div>
                            <div class="cons" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h3 style="color: #E57373; font-size: 1.25em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-times"></i> Disadvantages</h3>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Cannot detect new or unknown attacks</li>
                                    <li style="margin-bottom: 0px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Requires regular updates to the signature database</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                        <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-chart-line"></i> 2. Anomaly Detection</h3>
                        <p>Establishes a <span class="key-term">baseline of normal system behavior</span> and flags <span class="key-term">deviations from this norm</span> as potential threats.</p>
                        
                        <div class="analogy-content" style="background: var(--blue2); border-radius: 10px; padding: 15px 20px; margin-top: 20px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);">
                            <h4 style="color: var(--primary); font-size: 1.15em; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;"><i class="fas fa-lightbulb"></i> Analogy</h4>
                            <p>Like a bank noticing unusual spending patterns on your credit card.</p>
                        </div>
                        
                        <div class="pros-cons" style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 25px;">
                            <div class="pros" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h3 style="color: var(--primary); font-size: 1.25em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-check"></i> Advantages</h3>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Can detect new or previously unknown attacks</li>
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #4CAF50; margin-top: 4px;"></i> Adaptable to changing network behaviors</li>
                                </ul>
                            </div>
                            <div class="cons" style="flex: 1; background: var(--blue1); border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                                <h3 style="color: #E57373; font-size: 1.25em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-times"></i> Disadvantages</h3>
                                <ul style="list-style-type: none; padding-left: 0; margin-left: 0;">
                                    <li style="margin-bottom: 8px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Higher false positive rates due to normal behavior variations</li>
                                    <li style="margin-bottom: 0px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px;"><i class="fas fa-arrow-right" style="font-size: 0.8em; color: #EF5350; margin-top: 4px;"></i> Requires a learning period to establish accurate baselines</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-chart-bar"></i> IDS Performance Metrics</h3>
                    <p>This is a critical concept for evaluating the effectiveness of any detection system, illustrated by the potential overlap in behaviors:</p>
                    
                    <div class="image-placeholder" style="margin-top: 18px; margin-bottom: 18px; background: none; border: none; box-shadow: none; padding: 0; display: flex; justify-content: center; align-items: center; max-width: 800px;">
                        <i class="fas fa-chart-pie pulse"></i>
                        <p>Intruder vs Authorized User Behavior Diagram</p>
                        <div class="card-image">
                           <img src="media/image7.png" alt="Packet Filtering Firewall" style="width: 80%; height: auto; object-fit: contain; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        </div>
                    </div>
                    
                    <div class="firewall-types" style="margin-top: 18px; display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 24px;">
                        <div class="metric-card tp">
                            <h3 style="color: var(--primary); font-size: 1.25em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-check-circle"></i> True Positive (TP)</h3>
                            <p>The IDS correctly identifies an actual intrusion. (Good!)</p>
                        </div>
                        <div class="metric-card fp">
                            <h3 style="color: var(--primary); font-size: 1.25em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-exclamation-circle"></i> False Positive (FP)</h3>
                            <p>The IDS incorrectly flags legitimate activity as an intrusion. (Bad)</p>
                        </div>
                        <div class="metric-card fn">
                            <h3 style="color: var(--primary); font-size: 1.25em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-times-circle"></i> False Negative (FN)</h3>
                            <p>The IDS fails to detect an actual intrusion. (Very Bad - A real attack goes unnoticed)</p>
                        </div>
                        <div class="metric-card tn">
                            <h3 style="color: var(--primary); font-size: 1.25em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-check-circle"></i> True Negative (TN)</h3>
                            <p>The IDS correctly identifies legitimate activity as not an intrusion. (Good!)</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quiz Section -->
        <div id="quiz" class="section">
            <h2 class="section-title">Review Questions
                <button class="download-section-btn" onclick="downloadSectionPng(this)">
                    <i class="fas fa-download"></i>
                </button>
            </h2>
            
            <div class="subsection">
                <div class="firewall-card" style="background: var(--section-bg); color: var(--text-main); box-shadow: var(--shadow); border-radius: 15px; padding: 24px 20px 20px 20px; margin-bottom: 32px;">
                    <h3 style="color: var(--primary); font-size: 1.25em; font-weight: bold; display: flex; align-items: center; gap: 10px;"><i class="fas fa-graduation-cap"></i> Test Your Knowledge</h3>
                
                    <button id="toggleAllQuizAnswersBtn" style="background: var(--primary); color: white; border: none; padding: 8px 15px; border-radius: 20px; font-size: 0.9em; cursor: pointer; transition: background 0.3s, transform 0.2s; margin-bottom: 15px; float: right; display: flex; align-items: center; gap: 5px;">
                        <i class="fas fa-eye"></i> Show All Answers
                    </button>
                    <div style="clear: both;"></div>

                    <div class="firewall-types" style="margin-top: 18px; display: flex; flex-direction: column; gap: 24px;">
                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q1">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q1) List three design goals for a firewall? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q1" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <ol>
                                        <li>All traffic from inside to outside, and vice versa, must pass through the firewalls</li>
                                        <li>Only authorized traffic, as defined by the local security policy and rules, will be allowed to pass</li>
                                        <li>The firewall itself is immune to penetration</li>
                                    </ol>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q2">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q2) List four techniques used by firewalls to control access and enforce a security policy? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q2" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <ol>
                                        <li><strong>Service control:</strong> Decides which Internet services are allowed</li>
                                        <li><strong>Direction control:</strong> Controls whether service requests can flow into or out of the network</li>
                                        <li><strong>User control:</strong> Controls access according to which user is attempting to access it</li>
                                        <li><strong>Behavior control:</strong> Manages how certain services are used</li>
                                    </ol>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q3">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q3) What information is used by a typical packet filtering firewall? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q3" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <ul>
                                        <li>Source IP address - where the packet comes from</li>
                                        <li>Destination IP address - where the packet is going</li>
                                        <li>Port numbers - type of service being used</li>
                                        <li>Protocol - like TCP, UDP, or ICMP</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q4">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q4) What are some weaknesses of a packet filtering firewall? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q4" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <ul>
                                        <li>Only checks basic information (IP addresses, ports)</li>
                                        <li>Cannot see what's inside the packet content</li>
                                        <li>Cannot detect complex attacks or viruses</li>
                                        <li>No context awareness of connection state</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q5">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q5) What is the difference between a packet filtering firewall and a stateful inspection firewall? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q5" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <p><strong>Packet Filtering Firewall:</strong> Only examines individual packets based on basic criteria (IP addresses, ports, protocols) without considering the connection context.</p>
                                    <p><strong>Stateful Inspection Firewall:</strong> Not only examines individual packets but also remembers previous packets and tracks the state of connections, making decisions based on the entire connection context.</p>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q6">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q6) What is an application-level gateway? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q6" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <p>A type of firewall that acts as a security middleman between users and web servers, inspecting and filtering traffic at the Application Layer. It analyzes the actual content of communications based on application protocols like HTTP, rather than just examining packet headers.</p>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q7">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q7) What is a circuit-level gateway? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q7" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <p>A type of firewall that works at the Transport Layer to control network connections. It doesn't inspect the content of traffic, but ensures that connections (like TCP handshakes) are valid by creating separate connections between the user-gateway and gateway-external server.</p>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q8">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q8) What is a DMZ network and what types of systems would you expect to find on such networks? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q8" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <p><strong>DMZ (Demilitarized Zone):</strong> A special network zone that sits between the internal network and the external internet, acting as a buffer zone for hosting public services while protecting the internal network.</p>
                                    <p><strong>Typical systems in DMZ:</strong></p>
                                    <ul>
                                        <li>Web servers</li>
                                        <li>Email servers</li>
                                        <li>DNS servers</li>
                                        <li>FTP servers</li>
                                        <li>Public-facing application servers</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q9">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q9) What is the difference between an internal and an external firewall? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q9" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <p><strong>External Firewall:</strong> Sits between the external internet and the DMZ/internal network, protecting against outside threats and controlling what external traffic can enter the network.</p>
                                    <p><strong>Internal Firewall:</strong> Sits between the DMZ and the internal network, providing an additional layer of security to protect sensitive internal resources from both external threats and potentially compromised systems in the DMZ.</p>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q10">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q10) Explain the difference between host-based and network-based intrusion detection systems? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q10" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <p><strong>Host-Based IDS (HIDS):</strong> Monitors activities on individual devices (computers, servers) by examining system files, logs, and applications to detect unauthorized changes or suspicious behavior on that specific host.</p>
                                    <p><strong>Network-Based IDS (NIDS):</strong> Monitors the entire network's traffic by analyzing data packets moving across the network to detect suspicious activities, attack patterns, or anomalies in network communications.</p>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q11">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q11) What are the main logical components of an IDS? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q11" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <ol>
                                        <li><strong>Sensors:</strong> Responsible for collecting data from various sources</li>
                                        <li><strong>Analyzers:</strong> Receive input from sensors and determine if an intrusion has occurred</li>
                                        <li><strong>User Interface:</strong> Enables users to view output from the system or control its behavior</li>
                                    </ol>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-question">
                            <div class="interactive-element" data-toggle="q12">
                                <h3 style="color: var(--primary); font-size: 1.15em; margin-bottom: 0px; display: flex; align-items: center; gap: 8px;">Q12) What are the two main approaches to intrusion detection? <span class="toggle-arrow"><i class="fas fa-chevron-down"></i></span></h3>
                                <div class="toggle-content" id="q12" style="background: var(--blue3); border-radius: 5px; padding: 10px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                    <ol>
                                        <li><strong>Misuse Detection (Signature-Based):</strong> Compares incoming data to a database of known attack patterns (signatures) and triggers alerts when matches are found.</li>
                                        <li><strong>Anomaly Detection:</strong> Establishes a baseline of normal system behavior and flags deviations from this norm as potential threats.</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

   
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        // // Basic code protection - TEMPORARILY DISABLED FOR DEBUGGING
        // (function() {
        //     // Prevent viewing source code
        //     document.addEventListener('keydown', function(e) {
        //         if (e.ctrlKey && e.keyCode === 85) { // Ctrl+U
        //             e.preventDefault();
        //             return false;
        //         }
        //     });

        //     // Allow normal right-click, but show copyright notice if right-click with modifier keys
        //     document.addEventListener('contextmenu', function(e) {
        //         if (e.ctrlKey || e.shiftKey || e.altKey) {
        //             e.preventDefault();
        //             showCopyrightNotice();
        //             return false;
        //         }
        //         // Otherwise, allow normal right-click
        //     });

        //     // Show copyright notice on DevTools shortcuts
        //     document.addEventListener('keydown', function(e) {
        //         // Block Ctrl+Shift+I (Inspect)
        //         if (e.ctrlKey && e.shiftKey && e.keyCode === 73) {
        //             e.preventDefault();
        //             showCopyrightNotice();
        //             return false;
        //         }
        //         // Block F12
        //         if (e.keyCode === 123) {
        //             e.preventDefault();
        //             showCopyrightNotice();
        //             return false;
        //         }
        //         // Block Ctrl+Shift+J (Console)
        //         if (e.ctrlKey && e.shiftKey && e.keyCode === 74) {
        //             e.preventDefault();
        //             showCopyrightNotice();
        //             return false;
        //         }
        //         // Block Ctrl+Shift+C (Inspect Element)
        //         if (e.ctrlKey && e.shiftKey && e.keyCode === 67) {
        //             e.preventDefault();
        //             showCopyrightNotice();
        //             return false;
        //         }
        //     });

        //     // Optionally: Detect DevTools open by window size heuristics
        //     let devtoolsOpen = false;
        //     setInterval(function() {
        //         const widthThreshold = window.outerWidth - window.innerWidth > 160;
        //         const heightThreshold = window.outerHeight - window.innerHeight > 160;
        //         if ((widthThreshold || heightThreshold) && !devtoolsOpen) {
        //             devtoolsOpen = true;
        //             showCopyrightNotice();
        //         } else if (!(widthThreshold || heightThreshold)) {
        //             devtoolsOpen = false;
        //         }
        //     }, 1000);
        // })();

        // Theme toggle logic
        const themeSwitch = document.getElementById('themeSwitch');
        const root = document.documentElement;
        function setTheme(mode) {
            if (mode === 'dark') {
                root.setAttribute('data-theme', 'dark');
                themeSwitch.classList.add('dark');
            } else {
                root.removeAttribute('data-theme');
                themeSwitch.classList.remove('dark');
            }
            localStorage.setItem('theme', mode);
        }
        themeSwitch.addEventListener('click', function() {
            const isDark = root.getAttribute('data-theme') === 'dark';
            setTheme(isDark ? 'light' : 'dark');
        });
        // On load, set theme from localStorage or system preference
        (function() {
            const saved = localStorage.getItem('theme');
            if (saved) setTheme(saved);
            else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) setTheme('dark');
        })();

        // Progress bar functionality (scroll-based)
        function updateProgressBar() {
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const progress = (scrollTop / docHeight) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }
        window.addEventListener('scroll', updateProgressBar);

        // Navigation button active state on scroll
        function updateNavButtons() {
            const sections = document.querySelectorAll('.section');
            const navButtons = document.querySelectorAll('.nav-btn');
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                const sectionBottom = sectionTop + section.offsetHeight;
                if (window.scrollY >= sectionTop && window.scrollY < sectionBottom) {
                    navButtons.forEach(button => {
                        button.classList.remove('active');
                    });
                    const correspondingButton = document.querySelector(`.nav-btn[data-section="${section.id}"]`);
                    if (correspondingButton) {
                        correspondingButton.classList.add('active');
                    }
                }
            });
        }
        window.addEventListener('scroll', updateNavButtons);
        document.addEventListener('DOMContentLoaded', updateNavButtons);

        // Utility: Save and restore inline styles
        function saveStyles(el, props) {
            const saved = {};
            props.forEach(p => saved[p] = el.style[p]);
            return saved;
        }
        function restoreStyles(el, saved) {
            Object.keys(saved).forEach(p => el.style[p] = saved[p]);
        }
        function saveMultipleStyles(els, props) {
            return Array.from(els).map(el => saveStyles(el, props));
        }
        function restoreMultipleStyles(els, savedArr) {
            els.forEach((el, i) => restoreStyles(el, savedArr[i]));
        }

        // Download Word file (PDF fallback)
        function downloadWordFile() {
            window.open('assets/Sheet10_Firewalls__IDS.docx', '_blank');
        }

        // Copyright notice functionality
        function showCopyrightNotice() {
            const notification = document.getElementById('copyrightNotification');
            notification.classList.add('show');
            setTimeout(() => {
                if (notification.classList.contains('show')) {
                    hideCopyrightNotice();
                }
            }, 5000);
        }
        function hideCopyrightNotice() {
            const notification = document.getElementById('copyrightNotification');
            notification.classList.remove('show');
        }
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(showCopyrightNotice, 1000);
        });

        // Retain all original interactive logic for navigation, toggles, and quiz
        // Navigation functionality
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            // Update navigation buttons
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            // Find and activate the clicked button
            const clickedBtn = document.querySelector(`.nav-btn[data-section="${sectionId}"]`);
            if (clickedBtn) {
                clickedBtn.classList.add('active');
            }
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        // Toggle content functionality
        function toggleContent(element) {
            const toggleId = element.getAttribute('data-toggle');
            const content = document.getElementById(toggleId);
            if (content) {
                content.classList.toggle('show');
                element.classList.toggle('open'); // Toggle 'open' class on the interactive-element
                console.log(`[DEBUG] Toggle content for '${toggleId}'. Element open: ${element.classList.contains('open')}, Content show: ${content.classList.contains('show')}`);
                // Update click text
                const clickText = element.querySelector('p');
                if (clickText) {
                    if (content.classList.contains('show')) {
                        if (clickText.textContent.includes('Click to')) {
                            clickText.textContent = 'Click to collapse...';
                        }
                    } else {
                        if (clickText.textContent.includes('collapse')) {
                            clickText.textContent = clickText.textContent.replace('collapse', 'expand');
                        }
                    }
                }
            }
        }
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Register service worker for PWA functionality
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js')
                    .then(function(registration) {
                        console.log('[PWA] Service worker registered successfully:', registration.scope);
                    })
                    .catch(function(error) {
                        console.error('[PWA] Service worker registration failed:', error);
                    });
            }

            // Set up navigation buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const sectionId = this.getAttribute('data-section');
                    showSection(sectionId);
                });
            });
            // Set up interactive elements
            document.querySelectorAll('.interactive-element').forEach(element => {
                element.addEventListener('click', function() {
                    toggleContent(this);
                });
            });
            // Auto-expand objective cards on hover
            document.querySelectorAll('.objective-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    const content = this.querySelector('.toggle-content');
                    if (content) {
                        content.classList.add('show');
                    }
                });
                card.addEventListener('mouseleave', function() {
                    const content = this.querySelector('.toggle-content');
                    if (content) {
                        content.classList.remove('show');
                    }
                });
            });
            // Initialize progress bar
            updateProgressBar();

            // Handle navigation dropdown change
            const navDropdown = document.getElementById('navDropdown');
            if (navDropdown) {
                navDropdown.addEventListener('change', function() {
                    showSection(this.value);
                });
            }
        });

        // Interactive Firewalls Functions
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMContentLoaded for Interactive Firewalls Functions fired.');
            const cards = document.querySelectorAll('.firewall-function-card');
            console.log(`[DEBUG] Found ${cards.length} firewall-function-card elements.`);
            cards.forEach(card => {
                card.addEventListener('click', function(e) {
                    console.log('[DEBUG] firewall-function-card clicked:', this);
                    this.classList.toggle('open'); // Use 'this' instead of 'card' for clarity
                    console.log(`[DEBUG] Firewall function card has 'open' class: ${this.classList.contains('open')}`);
                });
            });
        });

        // JS for Limitations accordion
        document.addEventListener('DOMContentLoaded', function() {
          const limitationCards = document.querySelectorAll('.limitation-card');
          limitationCards.forEach(card => {
            card.addEventListener('click', function(e) {
              if (!e.target.closest('.limitation-content')) {
                limitationCards.forEach(c => { if (c !== card) c.classList.remove('open'); });
                card.classList.toggle('open');
              }
            });
            card.setAttribute('tabindex', '0');
            card.addEventListener('keydown', function(e) {
              if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                limitationCards.forEach(c => { if (c !== card) c.classList.remove('open'); });
                card.classList.toggle('open');
              }
            });
          });
        });

        // New: Toggle All Quiz Answers Functionality
        document.addEventListener('DOMContentLoaded', function() {
            const toggleButton = document.getElementById('toggleAllQuizAnswersBtn');
            const quizQuestions = document.querySelectorAll('#quiz .quiz-question .interactive-element');
            let allAnswersShown = false; // Track the state

            if (toggleButton) {
                toggleButton.addEventListener('click', function() {
                    allAnswersShown = !allAnswersShown; // Toggle the state

                    quizQuestions.forEach(function(element) {
                        const content = element.querySelector('.toggle-content');
                        if (content) {
                            if (allAnswersShown) {
                                element.classList.add('open');
                                content.classList.add('show');
                            } else {
                                element.classList.remove('open');
                                content.classList.remove('show');
                            }
                        }
                    });

                    // Update button text and icon
                    if (allAnswersShown) {
                        toggleButton.innerHTML = '<i class="fas fa-eye-slash"></i> Hide All Answers';
                        toggleButton.style.background = 'var(--secondary)'; // Example: change color when active
                    } else {
                        toggleButton.innerHTML = '<i class="fas fa-eye"></i> Show All Answers';
                        toggleButton.style.background = 'var(--primary)'; // Example: reset color
                    }
                });

                // Reset button state if individual answers are toggled (optional, for more complex sync)
                quizQuestions.forEach(function(element) {
                    element.addEventListener('click', function() {
                        // This is a simpler approach; a more robust one might recount open elements
                        // For now, if an individual is clicked, we assume the 'all' state is broken.
                        // If all are open, and one is closed, 'allAnswersShown' should become false.
                        // For simplicity, we just reset the button appearance here if any individual is toggled
                        // and the 'all' state is inconsistent.
                        const currentlyOpenCount = document.querySelectorAll('#quiz .quiz-question .interactive-element.open').length;
                        if (allAnswersShown && currentlyOpenCount < quizQuestions.length) {
                            allAnswersShown = false;
                            toggleButton.innerHTML = '<i class="fas fa-eye"></i> Show All Answers';
                            toggleButton.style.background = 'var(--primary)';
                        } else if (!allAnswersShown && currentlyOpenCount === quizQuestions.length) {
                             allAnswersShown = true;
                             toggleButton.innerHTML = '<i class="fas fa-eye-slash"></i> Hide All Answers';
                             toggleButton.style.background = 'var(--secondary)';
                        }
                    });
                });
            }
        });

        // New functions for PDF and PNG downloads
        // Removed window.jsPDF = window.jspdf.jsPDF; // Initialize jsPDF

        // Loading Screen functions
        const loadingScreen = document.getElementById('loadingScreen');

        function showLoadingScreen(message = 'Preparing...') {
            const loadingText = document.querySelector('.loading-text');
            loadingText.textContent = message;
            loadingScreen.classList.add('show');
        }

        function hideLoadingScreen() {
            loadingScreen.classList.remove('show');
        }

        // Store original states of collapsible elements and their styles
        const originalStates = new Map(); // Map<element, { classes: string[], wasOpen: boolean, wasShow: boolean, styles: Map<string, string> }>
        const originalContainerStyles = {}; // Store container styles

        // Function to preload all images and fonts before html2canvas runs
        async function preloadAssets() {
            console.log('[PRELOAD] Starting asset preloading...');
            const imagePromises = [];
            document.querySelectorAll('img').forEach(img => {
                if (img.src && !img.complete) {
                    imagePromises.push(new Promise((resolve, reject) => {
                        img.onload = resolve;
                        img.onerror = reject;
                    }));
                    console.log(`[PRELOAD] Queued image: ${img.src}`);
                }
            });

            // Wait for all images to load
            await Promise.allSettled(imagePromises);
            console.log('[PRELOAD] All images settled (loaded or failed).');

            // Wait for all fonts to load and be ready
            try {
                await document.fonts.ready;
                console.log('[PRELOAD] All fonts loaded and ready.');
            } catch (error) {
                console.warn('[PRELOAD] Error waiting for document.fonts.ready:', error);
            }
            console.log('[PRELOAD] Asset preloading complete.');
        }

        async function setSectionContentVisibility(targetElement, show) {
            console.log('setSectionContentVisibility called with show:', show); // Debugging log

            const elementsToOverride = targetElement.querySelectorAll(
                '.toggle-content, .function-content, .limitation-content, .question-answer, .analogy-content, ' +
                '.interactive-element, .firewall-function-card, .limitation-card, .question, .section'
            );

            // Properties to override for a clean capture
            const stylePropsToOverride = ['opacity', 'transform', 'transition', 'maxHeight', 'paddingTop', 'marginTop', 'display'];

            if (show) {
                // Save and force show content
                elementsToOverride.forEach(el => {
                    const elStyles = new Map();
                    stylePropsToOverride.forEach(prop => {
                        elStyles.set(prop, el.style[prop]); // Save current inline style
                        el.style[prop] = ''; // Clear inline style to let CSS rules apply for max-height/padding/margin
                    });
                    originalStates.set(el, {
                        classes: Array.from(el.classList),
                        styles: elStyles
                    });

                    // Force open/show
                    if (el.classList.contains('interactive-element') || el.classList.contains('firewall-function-card') || el.classList.contains('limitation-card') || el.classList.contains('question')) {
                        el.classList.add('open');
                        // Ensure directly affected content is also shown if not already a toggle-content
                        const content = el.querySelector('.toggle-content, .function-content, .limitation-content, .question-answer, .analogy-content');
                        if (content) content.classList.add('show');
                    } else if (el.classList.contains('toggle-content') || el.classList.contains('function-content') || el.classList.contains('limitation-content') || el.classList.contains('question-answer') || el.classList.contains('analogy-content')) {
                        el.classList.add('show');
                    }
                    
                    // Temporarily remove conflicting styles that affect html2canvas rendering
                    el.style.transition = 'none';
                    el.style.transform = 'none';
                    el.style.opacity = '1';
                    if (el.classList.contains('section')) {
                         el.style.display = 'block'; // Ensure section is displayed if it's currently hidden
                    }
                });

                // Prepare container for full-width screenshot if capturing the whole page or a large section
                const container = document.querySelector('.container');
                if (container) {
                    const containerProps = ['position','width','maxWidth','left','top','zIndex','boxShadow','background','overflow','margin','padding'];
                    containerProps.forEach(prop => {
                        originalContainerStyles[prop] = container.style[prop];
                    });
                    container.style.position = 'static';
                    container.style.width = '100vw';
                    container.style.maxWidth = '100vw';
                    container.style.left = '0';
                    container.style.top = '0';
                    container.style.zIndex = '9999';
                    container.style.boxShadow = 'none';
                    container.style.background = getComputedStyle(container).backgroundColor || 'white';
                    container.style.overflow = 'visible';
                    container.style.margin = '0';
                    container.style.padding = '0';
                }

            } else {
                // Restore original states
                elementsToOverride.forEach(el => {
                    if (originalStates.has(el)) {
                        const savedState = originalStates.get(el);
                        // Restore classes
                        el.className = ''; // Clear existing classes
                        savedState.classes.forEach(cls => el.classList.add(cls));
                        // Restore original inline styles
                        savedState.styles.forEach((value, prop) => {
                            el.style[prop] = value;
                        });
                    }
                });

                // Restore container styles
                const container = document.querySelector('.container');
                if (container) {
                    Object.keys(originalContainerStyles).forEach(prop => {
                        container.style[prop] = originalContainerStyles[prop];
                    });
                }
                originalStates.clear(); // Clear saved states for next capture
            }

            // Apply/remove screenshot-ready class to body (or container) for global styling adjustments
            document.body.classList.toggle('screenshot-ready', show);
            targetElement.classList.toggle('screenshot-ready', show);

            // Add small delays for DOM updates and rendering after style changes
            await new Promise(r => requestAnimationFrame(r)); // Ensures DOM is ready for next frame
            await new Promise(r => setTimeout(r, 50)); // Small delay for rendering completion
        }

        async function downloadSectionPng(button) {
            console.log('downloadSectionPng called!');
            showLoadingScreen('Preparing your image...'); // Updated message
            const section = button.closest('.section');
            if (!section) {
                hideLoadingScreen();
                return;
            }

            // Define a unique cache key for this section
            const cacheKey = `section_image_${section.id}`;
            let imgDataUrl = localStorage.getItem(cacheKey); // Try to get from cache

            // Hide download buttons and navigation
            const allButtons = document.querySelectorAll('.download-section-btn, .download-btn');
            allButtons.forEach(b => b.classList.add('screenshot-hide'));
            const nav = document.querySelector('.navigation');
            if (nav) nav.classList.add('screenshot-hide');

            try {
                if (imgDataUrl) {
                    console.log(`[CACHE] Image found in cache for section: ${section.id}`);
                    // Introduce a small delay to make the loading screen visible even for cached items
                    await new Promise(resolve => setTimeout(resolve, 800)); // Visible for 0.8 seconds
                } else {
                    console.log(`[CACHE] Image NOT found in cache for section: ${section.id}, generating...`);
                    await preloadAssets();
                    await setSectionContentVisibility(section, true);

                    const canvas = await html2canvas(section, {
                        backgroundColor: null,
                        useCORS: true,
                        scale: 2,
                        logging: false,
                        allowTaint: true
                    });
                    imgDataUrl = canvas.toDataURL('image/jpeg', 0.9);
                    localStorage.setItem(cacheKey, imgDataUrl);
                    console.log(`[CACHE] Image generated and saved to cache for section: ${section.id}`);
                }

                const link = document.createElement('a');
                link.download = section.id + '.jpeg';
                link.href = imgDataUrl;
                link.click();
            } catch (error) {
                console.error('Error generating or retrieving section PNG:', error);
                alert('Failed to generate or retrieve section image. Please try again.');
            } finally {
                await setSectionContentVisibility(section, false);

                // Show download buttons and navigation again
                allButtons.forEach(b => b.classList.remove('screenshot-hide'));
                if (nav) nav.classList.remove('screenshot-hide');
                hideLoadingScreen();
            }
        }

        async function downloadFullPageDocx() {
            console.log('downloadFullPageDocx called!');
            showLoadingScreen('Preparing your document...'); // Updated message

            // Hide download buttons and navigation
            const allButtons = document.querySelectorAll('.download-section-btn, .download-btn');
            allButtons.forEach(b => b.classList.add('screenshot-hide'));
            const nav = document.querySelector('.navigation');
            if (nav) nav.classList.add('screenshot-hide');

            const sectionsOrder = [
                'objectives',
                'firewalls',
                'firewall-types',
                'dmz',
                'ids',
                'quiz'
            ];

            const { Document, Packer, Paragraph, ImageRun } = docx;
            const doc = new Document({
                sections: []
            });
            console.log('[DOCX DEBUG] docx.Document initialized.');

            try {
                for (const sectionId of sectionsOrder) {
                    const section = document.getElementById(sectionId);
                    if (!section) {
                        console.warn(`[DOCX DEBUG] Section ${sectionId} not found, skipping.`);
                        continue;
                    }
                    console.log(`[DOCX DEBUG] Processing section: ${sectionId}`);

                    // Temporarily make the section active if it's not, to ensure it renders for html2canvas
                    const wasActive = section.classList.contains('active');
                    if (!wasActive) {
                        section.classList.add('active');
                        console.log(`[DOCX DEBUG] Added 'active' class to section ${sectionId}.`);
                        await new Promise(resolve => setTimeout(50));
                    }

                    // Expand all content within the current section and prepare styles
                    await setSectionContentVisibility(section, true);
                    console.log(`[DOCX DEBUG] Content visibility set to true for section ${sectionId}.`);

                    const canvas = await html2canvas(section, {
                        backgroundColor: null,
                        useCORS: true,
                        scale: 2,
                        logging: true,
                        allowTaint: true,
                    });
                    console.log(`[DOCX DEBUG] html2canvas generated canvas for section ${sectionId}.`);

                    const imgDataUrl = canvas.toDataURL('image/png');
                    const imgData = imgDataUrl.split(',')[1];
                    console.log(`[DOCX DEBUG] Converted canvas to imgDataUrl for section ${sectionId}.`);

                    // Calculate image dimensions to fit within a standard A4 page (approx)
                    const maxDocxWidthPx = 500;
                    const maxDocxHeightPx = 700;

                    let imgWidth = canvas.width;
                    let imgHeight = canvas.height;

                    // Scale image to fit within A4 landscape/portrait, preserving aspect ratio
                    if (imgWidth > maxDocxWidthPx) {
                        imgHeight = (imgHeight * maxDocxWidthPx) / imgWidth;
                        imgWidth = maxDocxWidthPx;
                    }
                    if (imgHeight > maxDocxHeightPx) {
                        imgWidth = (imgWidth * maxDocxHeightPx) / imgHeight;
                        imgHeight = maxDocxHeightPx;
                    }
                    console.log(`[DOCX DEBUG] Image dimensions for section ${sectionId}: ${imgWidth}x${imgHeight}`);

                    doc.addSection({
                        children: [
                            new Paragraph({
                                children: [
                                    new ImageRun({
                                        data: imgData,
                                        transformation: {
                                            width: imgWidth,
                                            height: imgHeight,
                                        },
                                    }),
                                ],
                            }),
                            new Paragraph({ text: "", pageBreakBefore: true }), // New page for the next section
                        ],
                    });
                    console.log(`[DOCX DEBUG] Section added to DOCX document for ${sectionId}.`);

                    // Revert content state and styles immediately after capturing the section
                    await setSectionContentVisibility(section, false);
                    console.log(`[DOCX DEBUG] Content visibility reverted for section ${sectionId}.`);

                    // Revert active state if it was temporarily added
                    if (!wasActive) {
                        section.classList.remove('active');
                        console.log(`[DOCX DEBUG] Removed 'active' class from section ${sectionId}.`);
                    }
                }
                console.log('[DOCX DEBUG] All sections processed. Attempting to pack document.');

                // Generate and save the DOCX file
                Packer.toBlob(doc).then(blob => {
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = 'Data_Security_Module.docx';
                    link.click();
                    console.log('[DOCX DEBUG] Word document generated and downloaded!');
                })
            } catch (error) {
                console.error('[DOCX ERROR] Error packing Word document:', error);
                alert('Failed to create Word document. Please try again and check console for errors.');
            } finally {
                // Show download buttons and navigation again
                allButtons.forEach(b => b.classList.remove('screenshot-hide'));
                if (nav) nav.classList.remove('screenshot-hide');
                console.log('[DOCX DEBUG] Download buttons and navigation shown again.');
                hideLoadingScreen();
            }
        }

        async function downloadFullPageZip() {
            console.log('downloadFullPageZip called!');
            showLoadingScreen('Preparing your zip file...'); // Updated message

            // Hide download buttons and navigation
            const allButtons = document.querySelectorAll('.download-section-btn, .download-btn');
            allButtons.forEach(b => b.classList.add('screenshot-hide'));
            const nav = document.querySelector('.navigation');
            if (nav) nav.classList.add('screenshot-hide');

            // Apply screenshot-ready class to body (or container) for global styling adjustments
            document.body.classList.add('screenshot-ready');
            const container = document.querySelector('.container');
            if (container) {
                // Temporarily store original container styles and override for capture
                const containerProps = ['position', 'width', 'maxWidth', 'left', 'top', 'zIndex', 'boxShadow', 'background', 'overflow', 'margin', 'padding'];
                containerProps.forEach(prop => {
                    originalContainerStyles[prop] = container.style[prop];
                });
                container.style.position = 'static';
                container.style.width = '100vw';
                container.style.maxWidth = '100vw';
                container.style.left = '0';
                container.style.top = '0';
                container.style.zIndex = '9999';
                container.style.boxShadow = 'none';
                container.style.background = getComputedStyle(container).backgroundColor || 'white';
                container.style.overflow = 'visible';
                container.style.margin = '0';
                container.style.padding = '0';
                container.classList.add('screenshot-ready');
            }

            const sectionsOrder = [
                'objectives',
                'firewalls',
                'firewall-types',
                'dmz',
                'ids',
                'quiz'
            ];

            const zip = new JSZip();
            let sectionCount = 0;

            try {
                await preloadAssets();

                for (const sectionId of sectionsOrder) {
                    const section = document.getElementById(sectionId);
                    if (!section) {
                        console.warn(`[ZIP DEBUG] Section ${sectionId} not found, skipping.`);
                        continue;
                    }
                    console.log(`[ZIP DEBUG] Processing section: ${sectionId}`);
                    sectionCount++;

                    // Store original section styles and apply temporary styles for capture
                    const originalSectionDisplay = section.style.display;
                    const originalSectionOverflow = section.style.overflow;
                    const originalSectionTransition = section.style.transition;
                    section.style.display = 'block';
                    section.style.overflow = 'visible';
                    section.style.transition = 'none';
                    section.classList.add('screenshot-ready');

                    // Store original states of collapsible elements within THIS section and force open/show
                    const elementsToOverride = section.querySelectorAll(
                        '.toggle-content, .function-content, .limitation-content, .question-answer, .analogy-content, ' +
                        '.interactive-element, .firewall-function-card, .limitation-card, .question'
                    );
                    const savedElementStates = new Map();
                    const stylePropsToOverride = ['opacity', 'transform', 'transition', 'maxHeight', 'paddingTop', 'marginTop', 'display', 'overflow'];

                    elementsToOverride.forEach(el => {
                        const elStyles = new Map();
                        stylePropsToOverride.forEach(prop => {
                            elStyles.set(prop, el.style[prop]);
                            el.style[prop] = '';
                        });
                        savedElementStates.set(el, {
                            classes: Array.from(el.classList),
                            styles: elStyles
                        });

                        // Force open/show
                        el.classList.add('open');
                        el.classList.add('show');
                        el.style.transition = 'none';
                        el.style.transform = 'none';
                        el.style.opacity = '1';
                        el.style.maxHeight = '20000px';
                        el.style.overflow = 'visible';

                        // For content divs, ensure padding and margin are applied for layout
                        if (el.classList.contains('toggle-content') || el.classList.contains('function-content') || el.classList.contains('limitation-content') || el.classList.contains('question-answer') || el.classList.contains('analogy-content')) {
                            el.style.paddingTop = '10px';
                            el.style.marginTop = '10px';
                        }
                    });
                    await new Promise(r => requestAnimationFrame(r));
                    await new Promise(r => setTimeout(r, 200));

                    console.log(`[ZIP DEBUG] Attempting html2canvas capture for section ${sectionId}...`);

                    const canvas = await html2canvas(section, {
                        backgroundColor: null,
                        useCORS: true,
                        scale: 2,
                        logging: true,
                        allowTaint: true,
                    });
                    console.log(`[ZIP DEBUG] html2canvas generated canvas for section ${sectionId}.`);

                    const imgDataUrl = canvas.toDataURL('image/jpeg', 0.9);
                    const imgDataBase64 = imgDataUrl.split(',')[1];
                    console.log(`[ZIP DEBUG] Converted canvas to Base64 for section ${sectionId}.`);

                    zip.file(`${sectionId}.jpeg`, imgDataBase64, { base64: true });
                    console.log(`[ZIP DEBUG] Image for section ${sectionId} added to ZIP.`);

                    // Restore original section styles
                    section.style.display = originalSectionDisplay;
                    section.style.overflow = originalSectionOverflow;
                    section.style.transition = originalSectionTransition;
                    section.classList.remove('screenshot-ready');

                    // Restore original states of collapsible elements within THIS section
                    elementsToOverride.forEach(el => {
                        if (savedElementStates.has(el)) {
                            const savedState = savedElementStates.get(el);
                            // Restore classes
                            el.className = '';
                            savedState.classes.forEach(cls => el.classList.add(cls));
                            // Restore original inline styles
                            savedState.styles.forEach((value, prop) => {
                                el.style[prop] = value;
                            });
                        }
                    });
                    console.log(`[ZIP DEBUG] Content visibility reverted for section ${sectionId}.`);
                }

                console.log('[ZIP DEBUG] All sections processed. Attempting to generate ZIP.');
                if (sectionCount === 0) {
                    console.warn('[ZIP DEBUG] No sections found to process for ZIP download.');
                    return;
                }

                // Generate and save the ZIP file
                zip.generateAsync({ type: 'blob' }).then(function (blob) {
                    saveAs(blob, 'Data_Security_Module_Sections.zip');
                    console.log('[ZIP DEBUG] ZIP file generated and downloaded!');
                })
            } catch (error) {
                console.error('[ZIP ERROR] Error generating or saving ZIP file:', error);
                alert('Failed to create or download ZIP file. Please check console for errors.');
            } finally {
                // Show download buttons and navigation again
                allButtons.forEach(b => b.classList.remove('screenshot-hide'));
                if (nav) nav.classList.remove('screenshot-hide');
                console.log('[ZIP DEBUG] Download buttons and navigation shown again.');

                // Restore global body and container styles
                document.body.classList.remove('screenshot-ready');
                if (container) {
                    Object.keys(originalContainerStyles).forEach(prop => {
                        container.style[prop] = originalContainerStyles[prop];
                    });
                    container.classList.remove('screenshot-ready');
                }
                hideLoadingScreen();
            }
        }

    </script>

    <footer>
        <div class="footer-content">        
            <p>Developed by <span class="brand">EOPeak</span> | <span class="developer">Eslam Osama Saad</span></p>
            <p>© 2025 Digital Logic Design Lab Manual | MSA University</p>
            <div class="copyright-notice">
                <button class="copyright-btn" onclick="showCopyrightNotice()">
                    <i class="fas fa-copyright"></i> All Rights Reserved
                </button>
            </div>
        </div>
    </footer>
    <div class="notification" id="copyrightNotification">
        <div class="notification-header">
            <div class="notification-title">
                <i class="fas fa-shield-alt"></i> Copyright Notice
            </div>
            <button class="notification-close" onclick="hideCopyrightNotice()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="notification-content">
            <p>This content is protected by copyright law. Unauthorized copying, distribution, or use of this material is strictly prohibited. The code, design, and content of this educational module are the exclusive property of the creator. Any reproduction or distribution without express written permission is a violation of copyright law.</p>
            <p class="disclaimer">This module is provided for educational purposes only. The creator makes no warranties about the completeness, reliability, or accuracy of this information.</p>
        </div>
    </div>
</body>
</html>
